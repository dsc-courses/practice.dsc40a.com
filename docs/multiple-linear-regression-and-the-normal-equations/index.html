<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Multiple Linear Regression and The Normal Equations</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="..\assets\theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Multiple Linear Regression and The Normal
Equations</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to practice.dsc40a.com</a></p>
<hr />
<p>This page contains all problems about Multiple Linear Regression and
The Normal Equations.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p><i>Source: <a href="../sp23-final-pt1/index.html">Spring 2023 Final
Part 1</a>, Problem 5</i></p>
<p>Suppose we want to predict how long it takes to run a Jupyter
notebook on Datahub. For 100 different Jupyter notebooks, we collect the
following 5 pieces of information:</p>
<ul>
<li><p><strong>cells</strong>: number of cells in the notebook</p></li>
<li><p><strong>lines</strong>: number of lines of code</p></li>
<li><p><strong>max iterations</strong>: largest number of iterations in
any loop in the notebook, or 1 if there are no loops</p></li>
<li><p><strong>variables</strong>: number of variables defined in the
notebook</p></li>
<li><p><strong>runtime</strong>: number of seconds for the notebook to
run on Datahub</p></li>
</ul>
<p>Then we use multiple regression to fit a prediction rule of the form
<span class="math display">H(\text{cells, lines, max iterations,
variables}) =  w_0 + w_1 \cdot \text{cells} \cdot \text{lines} + w_2
\cdot (\text{max iterations})^{\text{variables} - 10}</span></p>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p>What are the dimensions of the design matrix <span
class="math inline">X</span>?</p>
<p><span class="math display">\begin{bmatrix}
&amp; &amp; &amp; \\
&amp; &amp; &amp; \\
&amp; &amp; &amp; \\
\end{bmatrix}_{r \times c}</span></p>
<p>So, what should <span class="math inline">r</span> and <span
class="math inline">c</span> be for: <span class="math inline">r</span>
rows <span class="math inline">\times</span> <span
class="math inline">c</span> columns.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">100 \text{ rows} \times 3 \text{
columns}</span></p>
<p>There should be <span class="math inline">100</span> rows because
there are <span class="math inline">100</span> different Jupyter
notebooks with different information within them. There should be <span class="math inline">3</span> rows because there are three distinct
predictor variables: “cells,” “lines,” and the combined effect of “max
iterations” and “variables.”</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p>In <strong>one sentence</strong>, what does the entry in row 3,
column 2 of the design matrix X represent? (Count rows and columns
starting at 1, not 0).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>This entry represents the product of the number of cells and number
of lines of code for the third Jupyter notebook in the training
dataset.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p><i>Source: <a href="../sp23-final-pt1/index.html">Spring 2023 Final
Part 1</a>, Problem 6</i></p>
Now we solve the normal equations and find the solution to be
<span class="math display">\begin{aligned}
            \vec{w}^* &amp;= \begin{bmatrix} w_0^* \\ w_1^* \\ w_2^*
\end{bmatrix}
\end{aligned}</span>
Define a new vector:
<span class="math display">\begin{aligned}
            \vec{w}^{\circ} &amp;= \begin{bmatrix} w_0^{\circ} \\
w_1^{\circ} \\ w_2^{\circ} \end{bmatrix} = \begin{bmatrix} w_0^*+3 \\
w_1^*-4 \\ w_2^*-6 \end{bmatrix}
            
\end{aligned}</span>
<p>and consider the two prediction rules</p>
<span class="math display">\begin{aligned}
        H^*(\text{cells, lines, max iterations, variables})
&amp;=  w_0^* + w_1^* \cdot \text{cells} \cdot \text{lines} + w_2^*
\cdot (\text{max iterations})^{\text{variables} - 10}\\
        H^{\circ}(\text{cells, lines, max iterations, variables})
&amp;=  w_0^{\circ} + w_1^{\circ} \cdot \text{cells} \cdot \text{lines}
+ w_2^{\circ} \cdot (\text{max iterations})^{\text{variables} - 10}
        
\end{aligned}</span>
<p>Let <span class="math inline">\text{MSE}</span> represent the mean
squared error of a prediction rule, and let <span
class="math inline">\text{MAE}</span> represent the mean absolute error
of a prediction rule. Select the symbol that should go in each
blank.</p>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p><span class="math inline">\text{MSE}(H^*)</span> ___ <span
class="math inline">\text{MSE}(H^{\circ})</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">\leq</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\geq</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">=</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">\leq</span></p>
<p>Recall the equation for mean squared error: <span class="math inline">\text{MSE}(H(x_i)) =
\frac{1}{n}\sum_{i=1}^n(y_i-H(x_i))^2</span>. We can figure out which is
bigger by subtracting <span class="math inline">\text{MSE}(H^{\circ})</span> from <span class="math inline">\text{MSE}(H^*)</span>. The difference between the
squared differences is: <span class="math display">(y_i-H^*(x_i))^2-(y_i-H^{\circ}(x_i))^2</span>Notice
there is a squared element, which means that the differences of <span class="math inline">w^*_0 - w^{\circ}_0</span>, <span class="math inline">w^*_1 - w^{\circ}_1</span>, and <span class="math inline">w^*_2 - w^{\circ}_2</span> will appear as squared
terms, which are always positive! This means adding these squared
differences to <span class="math inline">H^*</span> will make it at
least as large as the squared difference for <span class="math inline">H^{\circ}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p><span class="math inline">(\text{MAE}(H^{\circ}))^2</span> ___ <span
class="math inline">\text{MSE}(H^{\circ})</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">\leq</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\geq</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">=</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">\geq</span></p>
<p>Recall the equation for mean absolute error: <span class="math inline">\text{MAE}(H(x_i)) =
\frac{1}{n}\sum_{i=1}^n|y_i-H(x_i)|</span>.</p>
<p>This equation looks very similar to the mean squared error! We can
actually take the square root of each sides of this equation to learn
more about which side is larger: <span class="math display">
\begin{align*}
(\text{MAE}(H^\circ))^2 &amp;\_\_\_ \text{MSE}(H^\circ) \\
\sqrt{(\text{MAE}(H^\circ))^2} &amp;\_\_\_ \sqrt{\text{MSE}(H^\circ)} \\
\text{MAE}(H^\circ) &amp;\_\_\_ \sqrt{\text{MSE}(H^\circ)}
\end{align*}
</span></p>
<p>The square root of <span class="math inline">\text{MSE}</span> is
equal to <span class="math inline">\text{MAE}</span>! These two elements
are basically the same because squaring a value will lead to
non-negatives and then it will be square rooted to match the absolute
value from <span class="math inline">\text{MAE}</span>. However the
<span class="math inline">\text{MSE}</span> being square rooted also
allows for it to be smaller than the <span class="math inline">\text{MSE}</span> making the correct symbol <span class="math inline">\geq</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p><i>Source: <a href="../wi22-midterm1/index.html">Winter 2022 Midterm
1</a>, Problem 4</i></p>
<p>Consider the dataset shown below.</p>
<div class="center">
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span
class="math inline">x^{(1)}</span></th>
<th style="text-align: left;"><span
class="math inline">x^{(2)}</span></th>
<th style="text-align: left;"><span
class="math inline">x^{(3)}</span></th>
<th style="text-align: left;"><span class="math inline">y</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">-5</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">-3</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">0</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>We want to use multiple regression to fit a prediction rule of the
form <span class="math display">H(x^{(1)}, x^{(2)}, x^{(3)}) = w_0 + w_1
x^{(1)}x^{(3)} + w_2 (x^{(2)}-x^{(3)})^2.</span> Write down the design
matrix <span class="math inline">X</span> and observation vector <span
class="math inline">\vec{y}</span> for this scenario. No justification
needed.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The design matrix <span class="math inline">X</span> and observation
vector <span class="math inline">\vec{y}</span> are given by</p>
<p><span class="math display">
\begin{align*}
X &amp;=
\begin{bmatrix}
1 &amp; 0 &amp; 4\\
1 &amp; 15 &amp; 1\\
1 &amp; -15 &amp; 4\\
1 &amp; 0 &amp; 1
\end{bmatrix} \\
&amp;\text{and} \\
\vec{y} &amp;= \begin{bmatrix}
-5\\
7\\
4\\
2
\end{bmatrix}
\end{align*}
</span></p>
<p>We got <span class="math inline">\vec{y}</span> by looking at our
dataset and seeing the <span class="math inline">y</span> column.</p>
<p>The matrix <span class="math inline">X</span> was found by looking at
the equation <span class="math inline">H(x)</span>. You can think of
each row of <span class="math inline">X</span> being: <span class="math inline">\begin{bmatrix}1 &amp; x^{(1)}x^{(3)} &amp;
(x^{(2)}-x^{(3)})^2\end{bmatrix}</span>. Recall our bias term here is
not affected by <span class="math inline">x^{(i)}</span>, but it still
exists! So we will always have the first element in our row be <span class="math inline">1</span>. We can then easily calculate the other
elements in the matrix.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>For the <span class="math inline">X</span> and <span
class="math inline">\vec{y}</span> that you have written down, let <span
class="math inline">\vec{w}</span> be the optimal parameter vector,
which comes from solving the normal equations <span
class="math inline">X^TX\vec{w}=X^T\vec{y}</span>. Let <span
class="math inline">\vec{e} = \vec{y} - X \vec{w}</span> be the error
vector, and let <span class="math inline">e_i</span> be the <span
class="math inline">i</span>th component of this error vector. Show that
<span class="math display">4e_1+e_2+4e_3+e_4=0.</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The key to this problem is the fact that the error vector, <span class="math inline">\vec{e}</span>, is orthogonal to the columns of the
design matrix, <span class="math inline">X</span>. As a refresher, if
<span class="math inline">\vec{w^*}</span> satisfies the normal
equations, then:</p>
<p>We can rewrite the normal equation (<span class="math inline">X^TX\vec{w}=X^T\vec{y}</span>) to allow substitution
for <span class="math inline">\vec{e} = \vec{y} - X \vec{w}</span>.</p>
<p><span class="math display">
\begin{align*}
X^TX\vec{w}&amp;=X^T\vec{y} \\
0 &amp;= X^T\vec{y} - X^TX\vec{w} \\
0 &amp;= X^T(\vec{y}-X\vec{w}) \\
0 &amp;= X^T\vec{e}
\end{align*}
</span></p>
<p>The first step is to find <span class="math inline">X^T</span>, which
is easy because we found <span class="math inline">X</span> above: <span class="math display">
\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 \\ 0 &amp; 15 &amp; -15 &amp; 0 \\ 4 &amp; 1
&amp; 4 &amp; 1
\end{bmatrix}
</span></p>
<p>And now we can plug <span class="math inline">X^T</span> and <span class="math inline">\vec e</span> into our equation <span class="math inline">0 = X^T\vec{e}</span>. It might be easiest to find
the right side first: <span class="math display">
\begin{align*}
X^T\vec{e} &amp;=
\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 \\ 0 &amp; 15 &amp; -15 &amp; 0 \\ 4 &amp; 1
&amp; 4 &amp; 1
\end{bmatrix} \cdot \begin{bmatrix} e_1 \\ e_2 \\ e_3 \\
e_4\end{bmatrix} \\
&amp;= \begin{bmatrix} e_1 + e_2 + e_3 + e_4 \\
15e_2 - 15e_3 \\ 4e_1 + e_2 + 4e_3 + e_4\end{bmatrix}
\end{align*}
</span></p>
<p>Finally, we set it equal to zero! <span class="math display">
\begin{align*}
0 &amp;= e_1 + e_2 + e_3 + e_4 \\
0 &amp;= 15e_2 - 15e_3 \\
0 &amp;= 4e_1 + e_2 + 4e_3 + e_4
\end{align*}
</span></p>
<p>With this we have shown that <span class="math inline">4e_1+e_2+4e_3+e_4=0</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p><i>Source: <a href="../wi24-midterm1/index.html">Winter 2024 Midterm
1</a>, Problem 5</i></p>
<p>Suppose the following information is given for linear regression:</p>
<p><span class="math inline">X = \begin{bmatrix}
1 &amp; 2\\
1 &amp; -1
\end{bmatrix}</span></p>
<p><span class="math inline">\vec{y} =
    \begin{bmatrix}
    a\\
    b\\
    \end{bmatrix}</span> <span class="math inline">\vec{w}^{*} =
    \begin{bmatrix}
    1\\
    2\\
    \end{bmatrix}</span></p>
<p>Where <span class="math inline">X</span> is the design matrix, <span
class="math inline">\vec{y}</span> is the observation vector, and <span
class="math inline">\vec{w}^{*}</span> is the optimal parameter vector.
Solve for parameters <span class="math inline">a</span> and <span
class="math inline">b</span> using the normal equations, show your
work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4" aria-expanded="true" aria-controls="collapse4">
Click to view the solution.
</button>
</h2>
<div id="collapse4" class="accordion-collapse collapse"
aria-labelledby="heading4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\begin{cases}
       a = 5\\
       b = -1\\
\end{cases}</span></p>
<p>Since <span class="math inline">\vec{w}^{*}</span> is the optimal
parameter vector, it must satisfy the normal equations:</p>
<p><span class="math display">\begin{align*}
        X^{T}X\vec{w} = X^{T}\vec{y}
\end{align*}</span></p>
<p>The left hand side of the equation will read:</p>
<p><span class="math display">\begin{align*}
X^{T}X\vec{w} &amp;=
\begin{bmatrix}
1 &amp; 1\\
2 &amp; -1
\end{bmatrix}

\begin{bmatrix}
1 &amp; 2\\
1 &amp; -1
\end{bmatrix}

\begin{bmatrix}
1\\
2
\end{bmatrix}
\\
&amp;=


\begin{bmatrix}
2 &amp; 1\\
1 &amp; 5
\end{bmatrix}

\begin{bmatrix}
1\\
2
\end{bmatrix}
\\
&amp;=

\begin{bmatrix}
4\\
11
\end{bmatrix}
\end{align*}</span></p>
<p>The right hand side of the equation is given by:</p>
<p><span class="math display">\begin{align*}
X^{T}\vec{y} &amp;=
\begin{bmatrix}
1 &amp; 1\\
2 &amp; -1
\end{bmatrix}
\begin{bmatrix}
a\\
b
\end{bmatrix}

\\
&amp;=

\begin{bmatrix}
a+b\\
2a-b
\end{bmatrix}
\end{align*}</span></p>
<p>By setting the left hand side and right hand side equal to each
other, we will obtain the following system of equations:</p>
<p><span class="math display">\begin{align*}
\begin{bmatrix}
4\\
11
\end{bmatrix}

=

\begin{bmatrix}
a+b\\
2a-b
\end{bmatrix}
\end{align*}</span></p>
<p><span class="math display">\begin{cases}
        &amp;4 = a + b\\
        &amp;11 = 2a-b
\end{cases}</span></p>
<p>To solve this equation set, we can add them together: <span class="math display">\begin{align*}
       4+11 &amp;= a + b + 2a -b\\
       3a &amp;= 15\\
       \\
       \\
\end{align*}</span></p>
<p><span class="math display">\begin{cases}
       a = 5\\
       b = -1\\
\end{cases}</span></p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p><i>Source: <a href="../wi24-final-pt1/index.html">Winter 2024 Final
Part 1</a>, Problem 4</i></p>
<p>Albert collected 400 data points from a radiation detector. Each data
point contains 3 features: feature <span class="math inline">A</span>,
feature <span class="math inline">B</span> and feature <span
class="math inline">C</span>. The true particle energy <span
class="math inline">E</span> is also reported. Albert wants to design a
linear regression algorithm to predict the energy <span
class="math inline">E</span> of each particle, given a combination of
one or more of feature <span class="math inline">A</span>, <span
class="math inline">B</span>, and <span class="math inline">C</span>. As
the first step, Albert calculated the correlation coefficients among
<span class="math inline">A</span>, <span class="math inline">B</span>,
<span class="math inline">C</span> and <span
class="math inline">E</span>. He wrote it down in the following table,
where each cell of the table represents the correlaton of two terms:</p>
<div>
<table>
<colgroup>
<col style="width: 23%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">A</span>   </th>
<th><span class="math inline">B</span>   </th>
<th><span class="math inline">C</span>   </th>
<th><span class="math inline">E</span>   </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">A</span></td>
<td>1</td>
<td>-0.99</td>
<td>0.13</td>
<td>0.8</td>
</tr>
<tr class="even">
<td><span class="math inline">B</span></td>
<td>-0.99</td>
<td>1</td>
<td>0.25</td>
<td>-0.95</td>
</tr>
<tr class="odd">
<td><span class="math inline">C</span></td>
<td>0.13</td>
<td>0.25</td>
<td>1</td>
<td>0.72</td>
</tr>
<tr class="even">
<td><span class="math inline">E</span></td>
<td>0.8</td>
<td>-0.95</td>
<td>0.72</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>Albert wants to start with a simple model: fitting only a single
feature to obtain the true energy (i.e. <span class="math inline">y =
w_0+w_1 x</span>). Which feature should he choose as <span
class="math inline">x</span> to get the lowest mean square error?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">A</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">B</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">C</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">B</span></p>
<p><span class="math inline">B</span> is the correct answer, because it
has the highest absolute correlation (0.95), the negative sign in front
of <span class="math inline">B</span> just means it is negatively
correlated to energy, and it can be compensated by a negative sign in
the weight.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>Albert wants to add another feature to his linear regression in part
(a) to further boost the model’s performance. (i.e. <span
class="math inline">y = w_0 + w_1 x + w_2 x_2</span>) Which feature
should he choose as <span class="math inline">x_2</span> to make
additional improvements?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">A</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">B</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">C</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">C</span></p>
<p><span class="math inline">C</span> is the correct answer, because
although <span class="math inline">A</span> has a higher correlation
with energy, it also has an extremely high correlation with <span class="math inline">B</span> (-0.99), that means adding <span class="math inline">A</span> into the fit will not be too useful, since
it provides almost the same information as <span class="math inline">B</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p>Albert further refines his algorithm by fitting a prediction rule of
the form: <span class="math display">\begin{aligned}
H(A,B,C) = w_0 + w_1 \cdot A\cdot C + w_2 \cdot B^{C-7}
\end{aligned}</span></p>
<p>Given this prediction rule, what are the dimensions of the design
matrix <span class="math inline">X</span>?</p>
<p><span class="math display">\begin{bmatrix}
&amp; &amp; &amp; \\
&amp; &amp; &amp; \\
&amp; &amp; &amp; \\
\end{bmatrix}_{r \times c}</span></p>
<p>So, what are <span class="math inline">r</span> and <span
class="math inline">c</span> in <span class="math inline">r \text{ rows}
\times c \text{ columns}</span>?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_3" aria-expanded="true" aria-controls="collapse5_3">
Click to view the solution.
</button>
</h2>
<div id="collapse5_3" class="accordion-collapse collapse"
aria-labelledby="heading5_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">400 \text{ rows} \times 3 \text{
columns}</span></p>
<p>Recall there are 400 data points, which means there will be 400 rows.
There will be 3 columns; one is the bias column of all <span class="math inline">1</span>s, one is for the feature <span class="math inline">A\cdot C</span>, and one is for the feature <span class="math inline">B^{C-7}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<!-- Commented out the last subproblem, because the solution is weird?? Need to rework. -->
<!-- <br>

### Problem 5.4



Now Albert solves the normal equations and finds the solution to be:
$$\vec{w}^* = \begin{bmatrix} w_0^* \\ w_1^* \\ w_2^*  \end{bmatrix}$$
To improve on this result, Albert decides to modify his design matrix
with the following steps:

1.  Add 1 to every entry to the first column

2.  Swap the second and the third column

Let $X_a$ be the modified design matrix. Let
$\vec{w_a}^* = (X_a^TX_a)^{-1}X_a^T\vec{y}$. 

Express the components
$\vec{w_a}^*$ in terms of $w_0^*, w_1^*, w_2^*$, which were the
components of $\vec{w}^*$.

$$\vec{w_a}^* = \begin{bmatrix} ? \\ ? \\ ? \\ \end{bmatrix}$$






<div class="accordion" id="accordionExample">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_4" aria-expanded="true" aria-controls="collapse5_4">
Click to view the solution.
</button>
</h2>
<div id="collapse5_4" class="accordion-collapse collapse collapse" aria-labelledby="heading5_4" data-bs-parent="#accordionExample">
<div class="accordion-body">

<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\vec{w}^* = \begin{bmatrix} w_0^*/2 \\
w_2^* \\ w_1^*  \end{bmatrix}</span></p>
<p>We should follow the steps Albert did to construct <span class="math inline">X</span>. We will add <span class="math inline">1</span> to be the first element in each row and
then switch the constants attached to <span class="math inline">w_1</span> (<span class="math inline">A \cdot
B</span>) and <span class="math inline">w_2</span> (<span class="math inline">B^{C-7}</span>): <span class="math display">
X_a = \begin{bmatrix}
1 &amp; B^{C-7} &amp; A \\
1 &amp; B^{C-7} &amp; A \\
\vdots &amp; \vdots &amp; \vdots \\
1 &amp; B^{C-7} &amp; A
\end{bmatrix}
</span></p>
<p>We know that <span class="math inline">X_\alpha^T X_\alpha</span> is
the same as an identity matrix. The inverse of an identity matrix is the
same as it was before.</p>
<p>This means we are really looking at <span class="math inline">X_\alpha^T \vec{y}</span>: <span class="math display">
\begin{align*}
X_\alpha^T \vec{y} &amp;= \begin{bmatrix}
1 &amp; 1 &amp; \cdots &amp; 1 \\
B^{C-7} &amp; B^{C-7} &amp; \cdots &amp; B^{C-7} \\
A &amp; A &amp; \cdots &amp; A
\end{bmatrix} \cdot \begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_{400}
\end{bmatrix} \\
&amp;= \begin{bmatrix}
\sum_{i = 1}^{400}{y_i}\\
\sum_{i = 1}^{400}{B^{C-7} \cdot y_i} \\
\sum_{i = 1}^{400}{A \cdot y_i}
\end{bmatrix}
\end{align*}
</span></p>
<p>The first component of our final matrix, <span class="math inline">sum_{i = 1}^{400}{y_i}</span>, is proportional to
<span class="math inline">w_0^*</span>. The second component of our
matrix, <span class="math inline">\sum_{i = 1}^{400}{B^{C-7} \cdot
y_i}</span>, is proportional to <span class="math inline">w_2^*</span>.
Finally, the third component of our matrix, <span class="math inline">\sum_{i = 1}^{400}{A \cdot y_i}</span>, is
proportional to <span class="math inline">w_1^*</span>.</p>

</div>
</div>
</div>
</div>




    
<br> -->
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion?
<a href="https://forms.gle/WZ71FchnXU1K154d7">Let us know
here</u></a>.</h4>
<hr />
</body>
</html>
