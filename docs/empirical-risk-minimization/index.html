<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Empirical Risk Minimization</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="..\assets\theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Empirical Risk Minimization</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to practice.dsc40a.com</a></p>
<hr />
<p>This page contains all problems about Empirical Risk
Minimization.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<!-- Loss/Risk Minimization -->
<p>King Triton just made an Instagram account and has been keeping track
of the number of likes his posts have received so far.</p>
<p>His first 7 posts have received a mean of 16 likes; the specific like
counts in sorted order are</p>
<p><span class="math display">8, 12, 12, 15, 18, 20, 27</span></p>
<p>King Triton wants to predict the number of likes his next post will
receive, using a constant prediction rule <span
class="math inline">h</span>. For each loss function <span
class="math inline">L(h, y)</span>, determine the constant prediction
<span class="math inline">h^*</span> that minimizes empirical risk. If
you believe there are multiplie minimizers, specify them all. If you
believe you need more information to answer the question or that there
is no minimizer, state that clearly. <strong>Give a brief justification
for each answer.</strong></p>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p><span class="math inline">L(h, y) = |y - h|</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="15" type="1">
<li></li>
</ol>
<p>This is absolute loss, and hence we’re looking for the minimizer of
mean absolute error, which is the median, 15.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p><span class="math inline">L(h, y) = (y - h)^2</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="16" type="1">
<li></li>
</ol>
<p>This is squared loss, and hence we’re looking for the minimizer of
mean squared error, which is the mean, 16.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.3">Problem 1.3</h3>
<p><span class="math inline">L(h, y) = 4(y - h)^2</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_3" aria-expanded="true" aria-controls="collapse1_3">
Click to view the solution.
</button>
</h2>
<div id="collapse1_3" class="accordion-collapse collapse"
aria-labelledby="heading1_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="16" type="1">
<li></li>
</ol>
<p>This is squared loss, multiplied by a constant. Note that when we go
to minimize empirical risk for this loss function, we will take the
derivative of empirical risk and set it equal to 0; at that point the
constant factor of 4 can be divided from both sides, so this problem
boils down to minimizing ordinary mean squared error. The only
difference is that the graph of mean squared error will be stretched
vertically by a factor of 4; the minimizing value will be in the same
place.</p>
<p>For more justification, here we consider any general re-scaling <span class="math inline">\alpha (y-h)^2</span>:</p>
<p><span class="math display">\begin{aligned}
    R_{sq}(h) &amp;= \frac{1}{n} \sum_{i = 1}^n \alpha (y_i - h)^2 \\
              &amp;= \alpha \cdot \frac{1}{n} \sum_{i = 1}^n (y_i - h)^2
\\
  \frac{d}{dh} R_{sq}(h) &amp;= \alpha \cdot \frac{1}{n} \sum_{i = 1}^n
2(y_i - h)(-1) = 0\\
  &amp;\implies -\frac{2\alpha}{n}\sum_{i = 1}^n (y_i - h) = 0 \\
  &amp;\implies \sum_{i = 1}^n (y_i - h) = 0 \\
  &amp;\implies h^* = \frac{1}{n} \sum_{i = 1}^n y_i
\end{aligned}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.4">Problem 1.4</h3>
<p><span class="math inline">L(h, y) = \begin{cases} 0 &amp; h = y \\
100 &amp; h \neq y \end{cases}</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_4" aria-expanded="true" aria-controls="collapse1_4">
Click to view the solution.
</button>
</h2>
<div id="collapse1_4" class="accordion-collapse collapse"
aria-labelledby="heading1_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="12" type="1">
<li></li>
</ol>
<p>This is a scaled version of 0-1 loss. We know that empirical risk for
0-1 loss is minimized at the mode, so that also applies here. The mode,
i.e. the most common value, is 12.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.5">Problem 1.5</h3>
<p><span class="math inline">L(h, y) = (3y - 4h)^2</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_5" aria-expanded="true" aria-controls="collapse1_5">
Click to view the solution.
</button>
</h2>
<div id="collapse1_5" class="accordion-collapse collapse"
aria-labelledby="heading1_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="12" type="1">
<li></li>
</ol>
<p>Note that we can write <span class="math inline">(3y - 4h)^2</span>
as <span class="math inline">\left( 3 \left( y - \frac{4}{3}h \right)
\right)^2 = 9 \left( y - \frac{4}{3}h \right)^2</span>. As we’ve seen,
the constant factor out front has no impact on the minimizing value.
Using the same principle as in the last part, we can say that <span class="math display">\frac{4}{3} h^* = \bar{x} \implies h^* =
\frac{3}{4} \bar{x} = \frac{3}{4} \cdot 16 = 12</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.6">Problem 1.6</h3>
<p><span class="math inline">L(h, y) = (y - h)^3</span></p>
<p><em>Hint: Do not spend too long on this subpart.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_6" aria-expanded="true" aria-controls="collapse1_6">
Click to view the solution.
</button>
</h2>
<div id="collapse1_6" class="accordion-collapse collapse"
aria-labelledby="heading1_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>No minimizer.</p>
<p>Note that unlike <span class="math inline">|y - h|</span>, <span class="math inline">(y - h)^2</span>, and all of the other loss
functions we’ve seen, <span class="math inline">(y - h)^3</span> tends
towards <span class="math inline">-\infty</span>, rather than having a
minimum output of 0. This means that there is no <span class="math inline">h</span> that minimizes <span class="math inline">\frac{1}{n} \sum_{i = 1}^n (y_i - h)^3</span>; the
larger we make <span class="math inline">h</span>, the more negative
(and hence “smaller") this empirical risk becomes.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<!-- Loss/Risk Minimization -->
<p>Consider a set of 23 data points <span class="math inline">y_1, y_2,
y_3, ..., y_{23}</span> such that <span class="math inline">y_1 &lt; y_2
&lt; ... &lt; y_{23}</span>. Let’s call this Dataset A.</p>
<p>We create a new dataset, Dataset B, by repeating each point in
Dataset A once. That is, Dataset B is the set of 46 points <span
class="math inline">y_1, y_1, y_2, y_2, ..., y_{23}, y_{23}</span>.</p>
<p>Answer the following questions regarding the relationship between
Dataset A and Dataset B. <strong>Justify your answers.</strong></p>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Suppose the minimizer of mean absolute error <span
class="math inline">R_{abs}(h)</span> for Dataset A is 5. What is the
minimizer of mean absolute error for Dataset B? If you believe there are
multiple minimizers, specify them all. If you believe you need more
information to answer the question, state that clearly.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The minimizer of MAE for Dataset B is still 5. Note that when we
repeat each data point, we go from having an odd number of data points
(23) to an even number (46). This means the minimizer is the set of all
values between the middle two values. But the middle two values will now
both be <span class="math inline">y_{12}</span>, and so there are no
numbers “in between" them – only <span class="math inline">y_{12}</span>
minimizes MAE.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Suppose the <em>mean absolute deviation from the median</em> for
Dataset A is 17. What is the <em>mean absolute deviation from the
median</em> for Dataset B? If you believe you need more information to
answer the question, state that clearly.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The mean absolute deviation from the median for Dataset B is still
17. As we saw in part a, the median itself does not change. When adding
together the deviations from the median, each point is repeated twice,
so the sum of all deviations from the median is doubled. However, there
are twice as many data points in Dataset B than there are in Dataset A,
so we divide by <span class="math inline">2n</span> (46) instead of
<span class="math inline">n</span> (23) in our average.</p>
<p>In short, for Dataset B both the numerator and denominator in the
calculation of mean absolute deviation from the median <span class="math inline">\frac{\sum_{i = 1}^n |y_i -
\text{Median}(y)|}{n}</span> are double what they were for Dataset A, so
the end result is the same as for Dataset A.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Suppose the function <span class="math inline">R_A(h)</span>
represents mean absolute error for Dataset A and <span
class="math inline">R_B(h)</span> represents mean absolute error for
Dataset B.</p>
<p>Is it true that <span class="math inline">R_A(h) = R_B(h)</span> for
any real number <span class="math inline">h</span>? (In other words, are
the graphs of <span class="math inline">R_A(h)</span> and <span
class="math inline">R_B(h)</span> identical?) Explain your
reasoning.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Yes they are.</p>
<p>Recall that the definition of <span class="math inline">R_{abs}(h)</span> is</p>
<p><span class="math display">R_{abs}(h) = \frac{1}{n} \sum_{i = 1}^n
|y_i - h|</span></p>
<p>For the first dataset, we have</p>
<p><span class="math display">R_{A}(h) = \frac{1}{23} \sum_{i = 1}^{23}
|y_i - h|</span></p>
<p>and for the second dataset, we have</p>
<p><span class="math display">\begin{aligned}
R_{B}(h) &amp;= \frac{1}{46} \sum_{i = 1}^{46} \left( |y_1 - h| + |y_1 -
h| + |y_2 - h| + |y_2 - h| + ... + |y_{23} - h| + |y_{23} - h| \right)
\\
&amp;= \frac{1}{46} \left( 2 \sum_{i = 1}^{23} |y_i - h| \right) \\
&amp;= \frac{1}{23} \sum_{i = 1}^{23} |y_i - h| \\ &amp;= R_{A}(h)
\end{aligned}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion?
<a href="https://forms.gle/WZ71FchnXU1K154d7">Let us know
here</u></a>.</h4>
<hr />
</body>
</html>
