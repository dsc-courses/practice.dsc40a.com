<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Empirical Risk Minimization</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="..\assets\theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Empirical Risk Minimization</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to practice.dsc40a.com</a></p>
<hr />
<p>This page contains all problems about Empirical Risk
Minimization.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p><i>Originally Problem 1 on the Fall 2021 Midterm.</i></p>
<p>King Triton just made an Instagram account and has been keeping track
of the number of likes his posts have received so far.</p>
<p>His first 7 posts have received a mean of 16 likes; the specific like
counts in sorted order are</p>
<p><span class="math display">8, 12, 12, 15, 18, 20, 27</span></p>
<p>King Triton wants to predict the number of likes his next post will
receive, using a constant prediction rule <span
class="math inline">h</span>. For each loss function <span
class="math inline">L(h, y)</span>, determine the constant prediction
<span class="math inline">h^*</span> that minimizes empirical risk. If
you believe there are multiplie minimizers, specify them all. If you
believe you need more information to answer the question or that there
is no minimizer, state that clearly. <strong>Give a brief justification
for each answer.</strong></p>
<p><br></p>
<h3 id="problem-1.1">Problem 1.1</h3>
<p><span class="math inline">L(h, y) = |y - h|</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_1" aria-expanded="true" aria-controls="collapse1_1">
Click to view the solution.
</button>
</h2>
<div id="collapse1_1" class="accordion-collapse collapse"
aria-labelledby="heading1_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="15" type="1">
<li></li>
</ol>
<p>This is absolute loss, and hence we’re looking for the minimizer of
mean absolute error, which is the median, 15.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.2">Problem 1.2</h3>
<p><span class="math inline">L(h, y) = (y - h)^2</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_2" aria-expanded="true" aria-controls="collapse1_2">
Click to view the solution.
</button>
</h2>
<div id="collapse1_2" class="accordion-collapse collapse"
aria-labelledby="heading1_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="16" type="1">
<li></li>
</ol>
<p>This is squared loss, and hence we’re looking for the minimizer of
mean squared error, which is the mean, 16.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.3">Problem 1.3</h3>
<p><span class="math inline">L(h, y) = 4(y - h)^2</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_3" aria-expanded="true" aria-controls="collapse1_3">
Click to view the solution.
</button>
</h2>
<div id="collapse1_3" class="accordion-collapse collapse"
aria-labelledby="heading1_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="16" type="1">
<li></li>
</ol>
<p>This is squared loss, multiplied by a constant. Note that when we go
to minimize empirical risk for this loss function, we will take the
derivative of empirical risk and set it equal to 0; at that point the
constant factor of 4 can be divided from both sides, so this problem
boils down to minimizing ordinary mean squared error. The only
difference is that the graph of mean squared error will be stretched
vertically by a factor of 4; the minimizing value will be in the same
place.</p>
<p>For more justification, here we consider any general re-scaling <span class="math inline">\alpha (y-h)^2</span>:</p>
<p><span class="math display">\begin{aligned}
    R_{sq}(h) &amp;= \frac{1}{n} \sum_{i = 1}^n \alpha (y_i - h)^2 \\
              &amp;= \alpha \cdot \frac{1}{n} \sum_{i = 1}^n (y_i - h)^2
\\
  \frac{d}{dh} R_{sq}(h) &amp;= \alpha \cdot \frac{1}{n} \sum_{i = 1}^n
2(y_i - h)(-1) = 0\\
  &amp;\implies -\frac{2\alpha}{n}\sum_{i = 1}^n (y_i - h) = 0 \\
  &amp;\implies \sum_{i = 1}^n (y_i - h) = 0 \\
  &amp;\implies h^* = \frac{1}{n} \sum_{i = 1}^n y_i
\end{aligned}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.4">Problem 1.4</h3>
<p><span class="math inline">L(h, y) = \begin{cases} 0 &amp; h = y \\
100 &amp; h \neq y \end{cases}</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_4" aria-expanded="true" aria-controls="collapse1_4">
Click to view the solution.
</button>
</h2>
<div id="collapse1_4" class="accordion-collapse collapse"
aria-labelledby="heading1_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="12" type="1">
<li></li>
</ol>
<p>This is a scaled version of 0-1 loss. We know that empirical risk for
0-1 loss is minimized at the mode, so that also applies here. The mode,
i.e. the most common value, is 12.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.5">Problem 1.5</h3>
<p><span class="math inline">L(h, y) = (3y - 4h)^2</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_5" aria-expanded="true" aria-controls="collapse1_5">
Click to view the solution.
</button>
</h2>
<div id="collapse1_5" class="accordion-collapse collapse"
aria-labelledby="heading1_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ol start="12" type="1">
<li></li>
</ol>
<p>Note that we can write <span class="math inline">(3y - 4h)^2</span>
as <span class="math inline">\left( 3 \left( y - \frac{4}{3}h \right)
\right)^2 = 9 \left( y - \frac{4}{3}h \right)^2</span>. As we’ve seen,
the constant factor out front has no impact on the minimizing value.
Using the same principle as in the last part, we can say that <span class="math display">\frac{4}{3} h^* = \bar{x} \implies h^* =
\frac{3}{4} \bar{x} = \frac{3}{4} \cdot 16 = 12</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-1.6">Problem 1.6</h3>
<p><span class="math inline">L(h, y) = (y - h)^3</span></p>
<p><em>Hint: Do not spend too long on this subpart.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1_6" aria-expanded="true" aria-controls="collapse1_6">
Click to view the solution.
</button>
</h2>
<div id="collapse1_6" class="accordion-collapse collapse"
aria-labelledby="heading1_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>No minimizer.</p>
<p>Note that unlike <span class="math inline">|y - h|</span>, <span class="math inline">(y - h)^2</span>, and all of the other loss
functions we’ve seen, <span class="math inline">(y - h)^3</span> tends
towards <span class="math inline">-\infty</span>, rather than having a
minimum output of 0. This means that there is no <span class="math inline">h</span> that minimizes <span class="math inline">\frac{1}{n} \sum_{i = 1}^n (y_i - h)^3</span>; the
larger we make <span class="math inline">h</span>, the more negative
(and hence “smaller") this empirical risk becomes.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p><i>Originally Problem 2 on the Fall 2021 Midterm.</i></p>
<p>Consider a set of 23 data points <span class="math inline">y_1, y_2,
y_3, ..., y_{23}</span> such that <span class="math inline">y_1 &lt; y_2
&lt; ... &lt; y_{23}</span>. Let’s call this Dataset A.</p>
<p>We create a new dataset, Dataset B, by repeating each point in
Dataset A once. That is, Dataset B is the set of 46 points <span
class="math inline">y_1, y_1, y_2, y_2, ..., y_{23}, y_{23}</span>.</p>
<p>Answer the following questions regarding the relationship between
Dataset A and Dataset B. <strong>Justify your answers.</strong></p>
<p><br></p>
<h3 id="problem-2.1">Problem 2.1</h3>
<p>Suppose the minimizer of mean absolute error <span
class="math inline">R_{abs}(h)</span> for Dataset A is 5. What is the
minimizer of mean absolute error for Dataset B? If you believe there are
multiple minimizers, specify them all. If you believe you need more
information to answer the question, state that clearly.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_1" aria-expanded="true" aria-controls="collapse2_1">
Click to view the solution.
</button>
</h2>
<div id="collapse2_1" class="accordion-collapse collapse"
aria-labelledby="heading2_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The minimizer of MAE for Dataset B is still 5. Note that when we
repeat each data point, we go from having an odd number of data points
(23) to an even number (46). This means the minimizer is the set of all
values between the middle two values. But the middle two values will now
both be <span class="math inline">y_{12}</span>, and so there are no
numbers “in between" them – only <span class="math inline">y_{12}</span>
minimizes MAE.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.2">Problem 2.2</h3>
<p>Suppose the <em>mean absolute deviation from the median</em> for
Dataset A is 17. What is the <em>mean absolute deviation from the
median</em> for Dataset B? If you believe you need more information to
answer the question, state that clearly.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_2" aria-expanded="true" aria-controls="collapse2_2">
Click to view the solution.
</button>
</h2>
<div id="collapse2_2" class="accordion-collapse collapse"
aria-labelledby="heading2_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The mean absolute deviation from the median for Dataset B is still
17. As we saw in previous part, the median itself does not change. When
adding together the deviations from the median, each point is repeated
twice, so the sum of all deviations from the median is doubled. However,
there are twice as many data points in Dataset B than there are in
Dataset A, so we divide by <span class="math inline">2n</span> (46)
instead of <span class="math inline">n</span> (23) in our average.</p>
<p>In short, for Dataset B both the numerator and denominator in the
calculation of mean absolute deviation from the median <span class="math inline">\frac{\sum_{i = 1}^n |y_i -
\text{Median}(y)|}{n}</span> are double what they were for Dataset A, so
the end result is the same as for Dataset A.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-2.3">Problem 2.3</h3>
<p>Suppose the function <span class="math inline">R_A(h)</span>
represents mean absolute error for Dataset A and <span
class="math inline">R_B(h)</span> represents mean absolute error for
Dataset B.</p>
<p>Is it true that <span class="math inline">R_A(h) = R_B(h)</span> for
any real number <span class="math inline">h</span>? (In other words, are
the graphs of <span class="math inline">R_A(h)</span> and <span
class="math inline">R_B(h)</span> identical?) Explain your
reasoning.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2_3" aria-expanded="true" aria-controls="collapse2_3">
Click to view the solution.
</button>
</h2>
<div id="collapse2_3" class="accordion-collapse collapse"
aria-labelledby="heading2_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Yes they are.</p>
<p>Recall that the definition of <span class="math inline">R_{abs}(h)</span> is</p>
<p><span class="math display">R_{abs}(h) = \frac{1}{n} \sum_{i = 1}^n
|y_i - h|</span></p>
<p>For the first dataset, we have</p>
<p><span class="math display">R_{A}(h) = \frac{1}{23} \sum_{i = 1}^{23}
|y_i - h|</span></p>
<p>and for the second dataset, we have</p>
<p><span class="math display">\begin{aligned}
R_{B}(h) &amp;= \frac{1}{46} \sum_{i = 1}^{46} \left( |y_1 - h| + |y_1 -
h| + |y_2 - h| + |y_2 - h| + ... + |y_{23} - h| + |y_{23} - h| \right)
\\
&amp;= \frac{1}{46} \left( 2 \sum_{i = 1}^{23} |y_i - h| \right) \\
&amp;= \frac{1}{23} \sum_{i = 1}^{23} |y_i - h| \\ &amp;= R_{A}(h)
\end{aligned}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p><em>Originally Problem 3 on the Fall 2022 Midterm Exam.</em></p>
<p>Mahdi runs a local pastry shop near UCSD and sells traditional desert
called Baklava. He bakes Baklavas every morning to keep his promise of
providing fresh Baklavas to his customers daily. Here is the amount of
Baklava he sold each day during last week in pounds(lb): <span
class="math display">y_1=100, y_2=110, y_3=75, y_4=90, y_5=105, y_6=90,
y_7=25</span></p>
<p>Mahdi needs your help as a data scientist to suggest <u>the best
constant prediction (<span class="math inline">h^*</span>) of daily
sales that minimizes the empirical risk using <span
class="math inline">L(h,y)</span> as the loss function</u>. Answer the
following questions and give a <strong>brief justification</strong> for
each part. <strong>This problem has many parts, if you get stuck, move
on and come back later!</strong></p>
<p><br></p>
<h3 id="problem-3.1">Problem 3.1</h3>
<p>Let <span class="math inline">L(h,y)=|y-h|</span>. What is <span
class="math inline">h^*</span>? (We’ll later refer to this prediction as
<span class="math inline">h_1^*</span>).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_1" aria-expanded="true" aria-controls="collapse3_1">
Click to view the solution.
</button>
</h2>
<div id="collapse3_1" class="accordion-collapse collapse"
aria-labelledby="heading3_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>As we have seen in lectures, the median minimizes the absolute loss
risk function. <span class="math display">h^*_1=\text{Median}(y_1,
\cdots, y_7).</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.2">Problem 3.2</h3>
<p>Let <span class="math inline">L(h,y)=(y-h)^2</span>. What is <span
class="math inline">h^*</span>? (We’ll later refer to this prediction as
<span class="math inline">h_2^*</span>).</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_2" aria-expanded="true" aria-controls="collapse3_2">
Click to view the solution.
</button>
</h2>
<div id="collapse3_2" class="accordion-collapse collapse"
aria-labelledby="heading3_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>As we have seen in lectures, the mean minimizes the square loss risk
function. <span class="math display">h^*_2=\text{Mean}(y_1, \cdots,
y_7).</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.3">Problem 3.3</h3>
<p><strong>True</strong> or <strong>False</strong>: Removing <span
class="math inline">y_1</span> and <span class="math inline">y_3</span>
from the dataset does not change <span
class="math inline">h_2^*</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_3" aria-expanded="true" aria-controls="collapse3_3">
Click to view the solution.
</button>
</h2>
<div id="collapse3_3" class="accordion-collapse collapse"
aria-labelledby="heading3_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>False</strong>. It changes the mean from <span class="math inline">85</span> to <span class="math inline">84</span>.
(However, the median is not changed.)</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.4">Problem 3.4</h3>
<p>Mahdi thinks that <span class="math inline">y_7</span> is an outlier.
Hence, he asks you to remove <span class="math inline">y_7</span> and
update your predictions in parts (a) and (b) accordingly. Without
calculating the new predictions, can you justify which prediction
changes <em>more</em>? <span class="math inline">h^*_1</span> or <span
class="math inline">h_2^*</span>?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_4" aria-expanded="true" aria-controls="collapse3_4">
Click to view the solution.
</button>
</h2>
<div id="collapse3_4" class="accordion-collapse collapse"
aria-labelledby="heading3_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The mean squared loss is more sensitive to outliers than absolute
loss, and removing data changes the mean more. Therefore, removing <span class="math inline">y_7</span> affects <span class="math inline">h_2^*</span> more than <span class="math inline">h_1^*</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.5">Problem 3.5</h3>
<p><strong>True</strong> or <strong>False</strong>: Let <span
class="math inline">L(y,h)=|y-h|^3</span>. You can use the Gradient
descent algorithm to find <span class="math inline">h^*</span>.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_5">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_5" aria-expanded="true" aria-controls="collapse3_5">
Click to view the solution.
</button>
</h2>
<div id="collapse3_5" class="accordion-collapse collapse"
aria-labelledby="heading3_5" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>False</strong>. The function <span class="math inline">|y-h|^3</span> is not differentiable everywhere so
we can not use the gradient descent to find the minimum.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.6">Problem 3.6</h3>
<p><strong>True</strong> or <strong>False</strong>: Let <span
class="math inline">L(y,h)=\sin(y-h)</span>. The Gradient descent
algorithm is guaranteed to converge, provided that a proper learning
rate is given.<br />
</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_6">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_6" aria-expanded="true" aria-controls="collapse3_6">
Click to view the solution.
</button>
</h2>
<div id="collapse3_6" class="accordion-collapse collapse"
aria-labelledby="heading3_6" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>False</strong>. The function is not convex, so the gradient
descent algorithm is not guaranteed to converge.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.7">Problem 3.7</h3>
<p>Mahdi has noticed that Baklava daily sale is associated with weather
temperature. So he asks you to incorporate this feature to get a better
prediction. Suppose the last week’s daily temperatures are <span
class="math inline">x_1, x_2, \cdots, x_7</span> in Fahrenheit (F). We
know that <span class="math inline">\bar x=65</span>, <span
class="math inline">\sigma_x=8.5</span> and the best linear prediction
that <u>minimizes the mean squared error</u> is <span
class="math inline">H^*(x)=-3x+w_0^*</span>.</p>
<p>What is the correlation coefficient (<span
class="math inline">r</span>) between <span class="math inline">x</span>
and <span class="math inline">y</span>? What does that mean?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_7">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_7" aria-expanded="true" aria-controls="collapse3_7">
Click to view the solution.
</button>
</h2>
<div id="collapse3_7" class="accordion-collapse collapse"
aria-labelledby="heading3_7" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>We know <span class="math inline">w_1^* =
\frac{\sigma_y}{\sigma_x}r.</span> We know that <span class="math inline">\sigma_x=8.5</span> and <span class="math inline">w_1^*=-3</span>. We can find <span class="math inline">\sigma_y</span> as follows:</p>
<p><span class="math display">\begin{aligned}
    \sigma_y^2 =&amp; \frac{1}{n} \sum_{i = 1}^n (y_i - \bar{y})^2\\
    =&amp;
\frac{1}{7}[(100-85)^2+(110-85)^2+(75-85)^2+(90-85)^2+(105-85)^2+(90-85)^2+(25-85)^2]\\
    =&amp;\frac{1}{7}[15^2+25^2+10^2+5^2+20^2+5^2+60^2]=714.28
\end{aligned}</span></p>
<p>Then, <span class="math inline">\sigma_y=26.7</span> which results in
<span class="math inline">r=-0.95</span>. That means the weather
temperature inversely affects Baklava sales, i.e., they are highly
negatively correlated.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.8">Problem 3.8</h3>
<p><strong>True</strong> or <strong>False</strong>: The unit of <span
class="math inline">r</span> is <span
class="math inline">\frac{lb}{F}</span> (Pound per Fahrenheit).</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> True</p></li>
<li><p><input type="radio" disabled="" /> False</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_8">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_8" aria-expanded="true" aria-controls="collapse3_8">
Click to view the solution.
</button>
</h2>
<div id="collapse3_8" class="accordion-collapse collapse"
aria-labelledby="heading3_8" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><strong>False.</strong> The correlation coefficient has no unit. (It
is always a unitless number in <span class="math inline">[-1,1]</span>
range.)</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.9">Problem 3.9</h3>
<p>Find <span class="math inline">w^*_0</span>. <em>(Hint: You’ll need
to find <span class="math inline">\bar y</span> for the given
dataset)</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_9">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_9" aria-expanded="true" aria-controls="collapse3_9">
Click to view the solution.
</button>
</h2>
<div id="collapse3_9" class="accordion-collapse collapse"
aria-labelledby="heading3_9" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Note that <span class="math inline">H(\bar x)=\bar y</span>.
Therefore, <span class="math display">\begin{aligned}
        H(65)=-3\cdot 65 +w_0^*=85 \xrightarrow[]{}w_0^*=280.
\end{aligned}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.10">Problem 3.10</h3>
<p>What would the best linear prediction <span
class="math inline">H^*(x)</span> be if we multiply all <span
class="math inline">x_i</span>’s by <span
class="math inline">2</span>?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_10">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_10" aria-expanded="true" aria-controls="collapse3_10">
Click to view the solution.
</button>
</h2>
<div id="collapse3_10" class="accordion-collapse collapse"
aria-labelledby="heading3_10" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The standard deviation scales by a factor of <span class="math inline">2</span>, i.e., <span class="math inline">\sigma_x'=2\cdot \sigma_x</span>.<br/> The same
is true for the mean, i.e., <span class="math inline">\bar{x}'=2
\cdot \bar{x}.</span> <br/> The correlation <span class="math inline">r</span>, standard deviation of the y-values <span class="math inline">\sigma_y</span>, and the mean of the y-values <span class="math inline">\bar y</span> do not change. <br/> (You can verify
these claims by plugging <span class="math inline">2x</span> in for
<span class="math inline">x</span> in their respective formulas and
seeing what happens, but it’s faster to <em>visually</em> reason why
this happens.)</p>
<p>Therefore, <span class="math inline">w_1'^*=\frac{\sigma_y'}{\sigma_x'}r'
= \frac{(\sigma_y)}{(2\cdot\sigma_x)}(r) = \frac{w_1^*}{2} =
-1.5</span>.</p>
<p>We can find <span class="math inline">w_0'^*</span> as
follows:</p>
<p><span class="math display">\begin{align*}
\bar{y}'&amp;=H(\bar{x}')\\&amp;=\frac{w_1^*}{2}(2\bar{x})+w_0'^*\\&amp;=w_1^*\bar{x}+w_0'^*
\\
&amp;\downarrow \\
(85) &amp;= -3(65) + w_0'^* \\
w_0'^*&amp;=280
\end{align*}</span></p>
<p>So, <span class="math inline">H^*(x)</span> would be <span class="math inline">-1.5x + 280</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-3.11">Problem 3.11</h3>
<p>What would the best linear prediction <span
class="math inline">H^*(x)</span> be if we add <span
class="math inline">20</span> to all <span
class="math inline">x_i</span>’s?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3_11">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3_11" aria-expanded="true" aria-controls="collapse3_11">
Click to view the solution.
</button>
</h2>
<div id="collapse3_11" class="accordion-collapse collapse"
aria-labelledby="heading3_11" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>All parameters remain unchanged except <span class="math inline">\bar{x}'=\bar{x}+20.</span> Since <span class="math inline">r</span>, <span class="math inline">\sigma_x</span>
and <span class="math inline">\sigma_y</span> are not changed, <span class="math inline">w_1^*</span> does not change. Then, one can find
<span class="math inline">w_0^*</span> as follows:</p>
<p><span class="math display">\begin{align*}
\bar{y}'&amp;=H(\bar{x}') \\
&amp;\downarrow \\
(85) &amp;=-3(65+20)+w_0^* \\
w_0^*&amp;=340
\end{align*}</span></p>
<p>So, <span class="math inline">H^*(x)</span> would be <span class="math inline">-3x + 340</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p><em>Originally Problem 4 on the Fall 2022 Midterm Exam.</em></p>
<p>Consider a dataset that consists of <span class="math inline">y_1,
\cdots, y_n</span>. In class, we used calculus to minimize mean squared
error, <span class="math inline">R_{sq}(h) = \frac{1}{n} \sum_{i = 1}^n
(h - y_i)^2</span>. In this problem, we want you to apply the same
approach to a slightly different loss function defined below: <span
class="math display">L_{\text{midterm}}(y,h)=(\alpha y - h)^2+\lambda
h</span></p>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>Write down the empiricial risk <span
class="math inline">R_{\text{midterm}}(h)</span> by using the above loss
function.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">R_{\text{midterm}}(h)=\frac{1}{n}\sum_{i=1}^{n}[(\alpha
y_i - h)^2+\lambda h]=[\frac{1}{n}\sum_{i=1}^{n}(\alpha y_i - h)^2]
+\lambda h</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>The mean of dataset is <span class="math inline">\bar{y}</span>, i.e.
<span class="math inline">\bar{y} = \frac{1}{n} \sum_{i = 1}^n
y_i</span>. Find <span class="math inline">h^*</span> that minimizes
<span class="math inline">R_{\text{midterm}}(h)</span> using calculus.
Your result should be in terms of <span
class="math inline">\bar{y}</span>, <span
class="math inline">\alpha</span> and <span
class="math inline">\lambda</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">
\begin{align*}
\frac{d}{dh}R_{\text{midterm}}(h)&amp;= [\frac{2}{n}\sum_{i=1}^{i=n}(h-
\alpha y_i  )] +\lambda \\
&amp;=2 h-2\alpha \bar{y} + \lambda.
\end{align*}
</span></p>
<p>By setting <span class="math inline">\frac{d}{dh}R_{\text{midterm}}(h)=0</span> we get
<span class="math display">2 h^*-2\alpha \bar{y} + \lambda=0 \Rightarrow
h^*=\alpha \bar{y} - \frac{\lambda}{2}.</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p><i>Originally Problem 1 on the Spring 2023 Final Part 1</i></p>
<p>For a given dataset <span class="math inline">\{y_1, y_2, \dots,
y_n\}</span>, let <span class="math inline">M_{abs}(h)</span> represent
the <strong>median</strong> absolute error of the constant prediction
<span class="math inline">h</span> on that dataset (as opposed to the
mean absolute error <span class="math inline">R_{abs}(h)</span>).</p>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>For the dataset <span class="math inline">\{4, 9, 10, 14,
15\}</span>, what is <span class="math inline">M_{abs}(9)</span>?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">5</span></p>
<p>The first step is to calculate the absolute errors (<span class="math inline">|y_i - h|</span>).</p>
<p><span class="math display">
\begin{align*}
\text{Absolute Errors} &amp;= \{|4-9|, |9-9|, |10-9|, |14-9|, |15-9|\}
\\
\text{Absolute Errors} &amp;= \{|-5|, |0|, |1|, |5|, |6|\} \\
\text{Absolute Errors} &amp;= \{5, 0, 1, 5, 6\}
\end{align*}
</span></p>
<p>Now we have to order the values inside of the absolute errors: <span class="math inline">\{0, 1, 5, 5, 6\}</span>. We can see the median is
<span class="math inline">5</span>, so <span class="math inline">M_{abs}(9) =5</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p>For the same dataset <span class="math inline">\{4, 9, 10, 14,
15\}</span>, find another integer <span class="math inline">h</span>
such that <span class="math inline">M_{abs}(9) = M_{abs}(h)</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">5</span> or <span class="math inline">15</span></p>
<p>Our goal is to find another number that will give us the same median
of absolute errors as in part (a).</p>
<p>One way to do this is to plug in a number and guess. Another way
requires noticing you can modify <span class="math inline">10</span>
(the middle element) to become <span class="math inline">5</span> in
either direction (negative or positive) because of the absolute
value.</p>
<p>We can solve this equation to get <span class="math inline">|10-x| =
5 \rightarrow x = 15 \text{ and } x = 5</span>.</p>
<p>We can then test this by following the same steps as we did in part
(a).</p>
<p><strong>For <span class="math inline">x = 15</span>:</strong> <span class="math display">
\begin{align*}
\text{Absolute Errors} &amp;= \{|4-15|, |9-15|, |10-15|, |14-15|,
|15-15|\} \\
\text{Absolute Errors} &amp;= \{|-11|, |-6|, |-5|, |-1|, |0|\} \\
\text{Absolute Errors} &amp;= \{11, 6, 5, 1, 0\}
\end{align*}
</span></p>
<p>Then we order the elements to get the absolute errors: <span class="math inline">\{0, 1, 5, 6, 11\}</span>. We can see the median is
<span class="math inline">5</span>, so <span class="math inline">M_{abs}(15) =5</span>.</p>
<p><strong>For <span class="math inline">x = 5</span>:</strong> <span class="math display">
\begin{align*}
\text{Absolute Errors} &amp;= \{|4-5|, |9-5|, |10-5|, |14-5|, |15-5|\}
\\
\text{Absolute Errors} &amp;= \{|-1|, |4|, |5|, |9|, |10|\} \\
\text{Absolute Errors} &amp;= \{1, 4, 5, 9, 10\}
\end{align*}
</span></p>
<p>We do not have to re-order the elements because they are in order
already. We can see the median is <span class="math inline">5</span>, so
<span class="math inline">M_{abs}(5) =5</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.3">Problem 5.3</h3>
<p>Based on your answers to parts (a) and (b), discuss in <strong>at
most two sentences</strong> what is problematic about using the median
absolute error to make predictions.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_3" aria-expanded="true" aria-controls="collapse5_3">
Click to view the solution.
</button>
</h2>
<div id="collapse5_3" class="accordion-collapse collapse"
aria-labelledby="heading5_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The numbers <span class="math inline">5</span> and <span class="math inline">15</span> are clearly bad predictions (close to the
extreme values in the dataset), yet they are considered just as good a
prediction by this metric as the number <span class="math inline">9</span>, which is roughly in the center of the
dataset. Intuitively, <span class="math inline">9</span> is a much
better prediction, but this way of measuring the quality of a prediction
does not recognize that.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p><i>Originally Problem 2 on the Spring 2023 Final Part 1</i></p>
<p>Match each dataset with the graph of its mean absolute error, <span
class="math inline">R_{abs}(h)</span>.</p>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<center><img src="../assets/images/sp23-final-pt1/matching.jpg" width="500" height="350"></center>
<p><br></p>
<p><span class="math inline">\{4, 7, 9, 10, 11\}</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Graph 1</p></li>
<li><p><input type="radio" disabled="" /> Graph 2</p></li>
<li><p><input type="radio" disabled="" /> Graph 3</p></li>
<li><p><input type="radio" disabled="" /> Graph 4</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Graph 2</p>
<p>The important thing to note here is the y axis is equal to <span class="math inline">R_{abs}(h)</span> and the x axis is equal to our
<span class="math inline">h</span>. The easiest way to figure out which
graph belongs to which dataset is to choose some numbers for <span class="math inline">h</span> and see if a line matches up with the
chosen points.</p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">h^*</span></th>
<th><span class="math inline">R_{abs}(h)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">0</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-0| =
\frac{1}{5} \cdot 41 \approx 8</span></td>
</tr>
<tr class="even">
<td><span class="math inline">8</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-8| =
\frac{1}{5} \cdot 11 = 2</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">18</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-18| =
\frac{1}{5} \cdot 49 \approx 10</span></td>
</tr>
</tbody>
</table>
<p><br/></p>
<p>When looking at these three places we can see that this dataset
matches Graph 2.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<center><img src="../assets/images/sp23-final-pt1/matching.jpg" width="500" height="350"></center>
<p><br></p>
<p><span class="math inline">\{-3, 1, 9, 11, 20\}</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Graph 1</p></li>
<li><p><input type="radio" disabled="" /> Graph 2</p></li>
<li><p><input type="radio" disabled="" /> Graph 3</p></li>
<li><p><input type="radio" disabled="" /> Graph 4</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Graph 1</p>
<p>We will use the same approach we used in part (a).</p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">h^*</span></th>
<th><span class="math inline">R_{abs}(h)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">0</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-0| =
\frac{1}{5} \cdot 44 \approx 9</span></td>
</tr>
<tr class="even">
<td><span class="math inline">8</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-8| =
\frac{1}{5} \cdot 34 \approx 7</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">18</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-18| =
\frac{1}{5} \cdot 56 \approx 11</span></td>
</tr>
</tbody>
</table>
<p><br/></p>
<p>When looking at these three places we can see that this dataset
matches Graph 1.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.3">Problem 6.3</h3>
<center><img src="../assets/images/sp23-final-pt1/matching.jpg" width="500" height="350"></center>
<p><br></p>
<p><span class="math inline">\{8, 9, 12, 13, 15\}</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Graph 1</p></li>
<li><p><input type="radio" disabled="" /> Graph 2</p></li>
<li><p><input type="radio" disabled="" /> Graph 3</p></li>
<li><p><input type="radio" disabled="" /> Graph 4</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_3" aria-expanded="true" aria-controls="collapse6_3">
Click to view the solution.
</button>
</h2>
<div id="collapse6_3" class="accordion-collapse collapse"
aria-labelledby="heading6_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Graph 3</p>
<p>We will use the same approach we used in the previous parts.</p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">h^*</span></th>
<th><span class="math inline">R_{abs}(h)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">0</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-0| =
\frac{1}{5} \cdot 44 \approx 11</span></td>
</tr>
<tr class="even">
<td><span class="math inline">8</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-8| =
\frac{1}{5} \cdot 17 \approx 3</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">18</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-18| =
\frac{1}{5} \cdot 33 \approx 7</span></td>
</tr>
</tbody>
</table>
<p><br/></p>
<p>When looking at these three places we can see that this dataset
matches Graph 3.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.4">Problem 6.4</h3>
<center><img src="../assets/images/sp23-final-pt1/matching.jpg" width="500" height="350"></center>
<p><br></p>
<p><span class="math inline">\{11, 12, 12, 13, 14\}</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> Graph 1</p></li>
<li><p><input type="radio" disabled="" /> Graph 2</p></li>
<li><p><input type="radio" disabled="" /> Graph 3</p></li>
<li><p><input type="radio" disabled="" /> Graph 4</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_4" aria-expanded="true" aria-controls="collapse6_4">
Click to view the solution.
</button>
</h2>
<div id="collapse6_4" class="accordion-collapse collapse"
aria-labelledby="heading6_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Graph 4</p>
<p>We will use the same approach we used in the previous parts.</p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">h^*</span></th>
<th><span class="math inline">R_{abs}(h)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">0</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-0| =
\frac{1}{5} \cdot 62 \approx 12</span></td>
</tr>
<tr class="even">
<td><span class="math inline">8</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-8| =
\frac{1}{5} \cdot 22 \approx 4</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">18</span></td>
<td><span class="math inline">\frac{1}{5}\sum_{i = 1}^{5}|y_i-18| =
\frac{1}{5} \cdot 28 \approx 6</span></td>
</tr>
</tbody>
</table>
<p><br/> When looking at these three places we can see that this dataset
matches Graph 4. Another way would be choosing the only option not
chosen in the other parts yet!</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p><i>Originally Problem 5c on the Spring 2023 Final Part 1</i></p>
Now we solve the normal equations and find the solution to be
<span class="math display">\begin{aligned}
            \vec{w}^* &amp;= \begin{bmatrix} w_0^* \\ w_1^* \\ w_2^*
\end{bmatrix}
\end{aligned}</span>
Define a new vector:
<span class="math display">\begin{aligned}
            \vec{w}^{\circ} &amp;= \begin{bmatrix} w_0^{\circ} \\
w_1^{\circ} \\ w_2^{\circ} \end{bmatrix} = \begin{bmatrix} w_0^*+3 \\
w_1^*-4 \\ w_2^*-6 \end{bmatrix}
            
\end{aligned}</span>
<p>and consider the two prediction rules</p>
<span class="math display">\begin{aligned}
        H^*(\text{cells, lines, max iterations, variables})
&amp;=  w_0^* + w_1^* \cdot \text{cells} \cdot \text{lines} + w_2^*
\cdot (\text{max iterations})^{\text{variables} - 10}\\
        H^{\circ}(\text{cells, lines, max iterations, variables})
&amp;=  w_0^{\circ} + w_1^{\circ} \cdot \text{cells} \cdot \text{lines}
+ w_2^{\circ} \cdot (\text{max iterations})^{\text{variables} - 10}
        
\end{aligned}</span>
<p>Let <span class="math inline">\text{MSE}</span> represent the mean
squared error of a prediction rule, and let <span
class="math inline">\text{MAE}</span> represent the mean absolute error
of a prediction rule. Select the symbol that should go in each
blank.</p>
<p><br></p>
<h3 id="problem-7.1">Problem 7.1</h3>
<p><span class="math inline">\text{MSE}(H^*)</span> ___ <span
class="math inline">\text{MSE}(H^{\circ})</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">\leq</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\geq</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">=</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_1" aria-expanded="true" aria-controls="collapse7_1">
Click to view the solution.
</button>
</h2>
<div id="collapse7_1" class="accordion-collapse collapse"
aria-labelledby="heading7_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">\leq</span></p>
<p>Recall the equation for mean squared error: <span class="math inline">\text{MSE}(H(x_i)) =
\frac{1}{n}\sum_{i=1}^n(y_i-H(x_i))^2</span>. We can figure out which is
bigger by subtracting <span class="math inline">\text{MSE}(H^{\circ})</span> from <span class="math inline">\text{MSE}(H^*)</span>. The difference between the
squared differences is: <span class="math display">(y_i-H^*(x_i))^2-(y_i-H^{\circ}(x_i))^2</span>Notice
there is a squared element, which means that the differences of <span class="math inline">w^*_0 - w^{\circ}_0</span>, <span class="math inline">w^*_1 - w^{\circ}_1</span>, and <span class="math inline">w^*_2 - w^{\circ}_2</span> will appear as squared
terms, which are always positive! This means adding these squared
differences to <span class="math inline">H^*</span> will make it at
least as large as the squared difference for <span class="math inline">H^{\circ}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-7.2">Problem 7.2</h3>
<p><span class="math inline">(\text{MAE}(H^{\circ}))^2</span> ___ <span
class="math inline">\text{MSE}(H^{\circ})</span></p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> <span class="math inline">\leq</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">\geq</span></p></li>
<li><p><input type="radio" disabled="" /> <span class="math inline">=</span></p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_2" aria-expanded="true" aria-controls="collapse7_2">
Click to view the solution.
</button>
</h2>
<div id="collapse7_2" class="accordion-collapse collapse"
aria-labelledby="heading7_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">\geq</span></p>
<p>Recall the equation for mean absolute error: <span class="math inline">\text{MAE}(H(x_i)) =
\frac{1}{n}\sum_{i=1}^n|y_i-H(x_i)|</span>.</p>
<p>This equation looks very similar to the mean squared error! We can
actually take the square root of each sides of this equation to learn
more about which side is larger: <span class="math display">
\begin{align*}
(\text{MAE}(H^\circ))^2 &amp;\_\_\_ \text{MSE}(H^\circ) \\
\sqrt{(\text{MAE}(H^\circ))^2} &amp;\_\_\_ \sqrt{\text{MSE}(H^\circ)} \\
\text{MAE}(H^\circ) &amp;\_\_\_ \sqrt{\text{MSE}(H^\circ)}
\end{align*}
</span></p>
<p>The square root of <span class="math inline">\text{MSE}</span> is
equal to <span class="math inline">\text{MAE}</span>! These two elements
are basically the same because squaring a value will lead to
non-negatives and then it will be square rooted to match the absolute
value from <span class="math inline">\text{MAE}</span>. However the
<span class="math inline">\text{MSE}</span> being square rooted also
allows for it to be smaller than the <span class="math inline">\text{MSE}</span> making the correct symbol <span class="math inline">\geq</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-8">Problem 8</h2>
<p><i>Originally Problem 1 on the first Midterm of Spring 2023</i></p>
<p>Consider a dataset such that <span class="math inline">60 \leq y_1
\leq y_2 \leq \dots \leq y_n</span>. Let <span
class="math inline">R_{abs}(h)</span> represent the mean absolute error
of a constant prediction <span class="math inline">h</span> on this
dataset. Suppose we know that <span class="math inline">R_{abs}(27) =
94.</span></p>
<p><br></p>
<h3 id="problem-8.1">Problem 8.1</h3>
<p>Find <span class="math inline">\bar y</span>, or the mean of <span
class="math inline">\{y_1, y_2, \dots, y_n\}</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_1" aria-expanded="true" aria-controls="collapse8_1">
Click to view the solution.
</button>
</h2>
<div id="collapse8_1" class="accordion-collapse collapse"
aria-labelledby="heading8_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>There are several ways to do this problem. One way is to interpret
mean absolute error of a constant prediction <span class="math inline">h</span> as the average distance of each data point
to <span class="math inline">h</span>. So we are told that the average
distance of each data point to <span class="math inline">27</span> is
<span class="math inline">94</span>. That is, the data points are <span class="math inline">94</span> units away from <span class="math inline">27</span> on average. Since all the data is at least
<span class="math inline">60</span>, they must be <span class="math inline">94</span> units <em>more</em> than <span class="math inline">27</span>, or <span class="math inline">121</span>,
on average.</p>
<center><img height="166" src="../../assets/images/sp23-midterm1/p1/1a.jpg" width="666"/></center>
<p>You can also arrive at the same answer algebraically using the
definition of <span class="math inline">R_{abs}(h)</span>. We have <span class="math display">\begin{aligned} R_{abs}(h) &amp;= \frac1n
\sum_{i=1}^{n}|y_i - h| \\ R_{abs}(27) &amp;= \frac1n \sum_{i=1}^{n}|y_i
- 27| \\ &amp;= \frac1n \sum_{i=1}^{n}(y_i - 27) \qquad \text{because
each~} y_i\geq 60 \\ &amp;= \frac1n\left( \sum_{i=1}^{n}y_i -
\sum_{i=1}^{n}27\right) \\ &amp;= \frac1n\left( n\cdot\bar y -
n\cdot27\right) \\ &amp;= \bar y - 27 \end{aligned}</span></p>
<p>Since we are told that <span class="math inline">R(27) = 94</span>,
we can set <span class="math inline">\bar y - 27 = 94</span>, to find
that <span class="math inline">\bar y = 121</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-8.2">Problem 8.2</h3>
<p>Find <span class="math inline">R_{abs}(58)</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_2" aria-expanded="true" aria-controls="collapse8_2">
Click to view the solution.
</button>
</h2>
<div id="collapse8_2" class="accordion-collapse collapse"
aria-labelledby="heading8_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>Again, we can do this problem in multiple ways. Interpreting <span class="math inline">R_{abs}(h)</span> as the average distance of each
data point to <span class="math inline">h</span>, we can see that since
<span class="math inline">58</span> is <span class="math inline">31</span> units closer to each data point than <span class="math inline">27</span>, <span class="math inline">R_{abs}(58) =
R_{abs}(27) - 31 = 94 - 31 = 63.</span></p>
<p>Another way to do this problem uses the answer from part (a). Since
the data points average to <span class="math inline">121</span>, their
distance to <span class="math inline">58</span> is <span class="math inline">121-58 = 63</span>, on average.</p>
<center><img height="166" src="../../assets/images/sp23-midterm1/p1/1b.jpg" width="666"/></center>
</div>
</div>
</div>
</div>
<p><br></p>
<p><br></p>
<h3 id="problem-8.3">Problem 8.3</h3>
<p>Which of the following <em>could</em> be the mean absolute deviation
from the median for this dataset? There is only one correct answer.</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 18</p></li>
<li><p><input type="radio" disabled="" /> 62</p></li>
<li><p><input type="radio" disabled="" /> 94</p></li>
<li><p><input type="radio" disabled="" /> 102</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_3" aria-expanded="true" aria-controls="collapse8_3">
Click to view the solution.
</button>
</h2>
<div id="collapse8_3" class="accordion-collapse collapse"
aria-labelledby="heading8_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>One easy way to do this problem is to recognize that none of these
values are too low, but they may be too high. For example, the mean
absolute deviation from the median can be as low as <span class="math inline">0</span>, when all the data points are the same.
Since we are told there is only one correct answer and we know that no
answer choice is too low, that means the correct answer must be the
lowest option, <span class="math inline">18</span>.</p>
<p>We can also rule out all the other answer choices to show that they
are too high. To do that, we’ll show that <span class="math inline">62</span> is too high, and therefore, both <span class="math inline">94</span> and <span class="math inline">102</span>
are too high as well. We are told that all data points are at least
<span class="math inline">60</span>. By similar logic as we used in part
(b), we can see that <span class="math inline">R_{abs}(60) = 61</span>.
Since the minimum value of <span class="math inline">R_{abs}(h)</span>
occurs at the median <span class="math inline">h^*\geq 60</span> and we
already know <span class="math inline">R_{abs}(60) = 61</span>, it must
be the case that <span class="math inline">R(h^*) \leq 61</span>.</p>
<center><img height="166" src="../../assets/images/sp23-midterm1/p1/1c.jpg" width="666"/></center>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-9">Problem 9</h2>
<p><i>Originally Problem 2 on the first Midterm of Spring 2023</i></p>
<p>Let <span class="math inline">R_{sq}(h)</span> represent the mean
squared error of a constant prediction <span
class="math inline">h</span> for a given dataset. Find a dataset <span
class="math inline">\{y_1, y_2\}</span> such that the graph of <span
class="math inline">R_{sq}(h)</span> has its minimum at the point <span
class="math inline">(7,16)</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9" aria-expanded="true" aria-controls="collapse9">
Click to view the solution.
</button>
</h2>
<div id="collapse9" class="accordion-collapse collapse"
aria-labelledby="heading9" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>We’ve already learned that <span class="math inline">R_{sq}(h)</span>
is minimized at the mean of the data, and the minimum value of <span class="math inline">R_sq(h)</span> is the variance of the data. So we
need to provide a dataset of two points with a mean of <span class="math inline">7</span> and a variance of <span class="math inline">16</span>. Recall that the variance is the average
squared distance of each data point to the mean. Since we want a
variance of <span class="math inline">16</span>, we can make each point
<span class="math inline">4</span> units away from the mean. Therefore,
our data set can be <span class="math inline">y_1 = 3, y_2 = 11.</span>
In fact, this is the only solution.</p>
<p>A more calculative approach uses the formulas for mean and variance
and solves a system of two equations:</p>
<p><span class="math display">\begin{aligned} \frac{y_1+y_2}{2} &amp;= 7
\\ \frac12 \left((y_1 - 7)^2 + (y_2 - 7)^2 \right) &amp;= 16
\end{aligned}</span></p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-10">Problem 10</h2>
<p><i>Originally Problem 2 on the first Midterm of Winter 2022</i></p>
<p>Consider a new loss function, <span class="math display">L(h, y) =
e^{(h-y)^2}.</span> Given a dataset <span class="math inline">y_1, y_2,
\dots, y_n</span>, let <span class="math inline">R(h)</span> represent
the empirical risk for the dataset using this loss function.</p>
<p><br></p>
<h3 id="problem-10.1">Problem 10.1</h3>
<p>For the dataset <span class="math inline">\{1, 3, 4\}</span>,
calculate <span class="math inline">R(2).</span> Simplify your answer as
much as possible without a calculator.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading10_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse10_1" aria-expanded="true" aria-controls="collapse10_1">
Click to view the solution.
</button>
</h2>
<div id="collapse10_1" class="accordion-collapse collapse"
aria-labelledby="heading10_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>We need to calculate the loss for each data point then average the
losses. That is, we need to calculate <span class="math display">R(2) =
\dfrac{1}{3} \sum_{i=1}^{3} e^{(2-y_i)^2}.</span> The table below
records the necessary information:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">y_i</span></th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">3</th>
<th style="text-align: left;">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">2-y_i</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">-2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">(2-y_i)^2</span></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">e^{(2-y_i)^2}</span></td>
<td style="text-align: left;"><span class="math inline">e</span></td>
<td style="text-align: left;"><span class="math inline">e</span></td>
<td style="text-align: left;"><span class="math inline">e^4</span></td>
</tr>
</tbody>
</table>
<p><br/></p>
<p>This means: <span class="math display">\begin{aligned} R(2) &amp;=
\dfrac{1}{3} \sum_{i=1}^{3} e^{(2-y_i)^2} \\ &amp;= \frac13 (e+e+e^4) \\
&amp;= \frac13 (2e+e^4)  \end{aligned}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-10.2">Problem 10.2</h3>
<p>For the same dataset <span class="math inline">\{1, 3, 4\}</span>,
perform one iteration of gradient descent on <span
class="math inline">R(h)</span>, starting at an initial prediction of
<span class="math inline">h_0=2</span> with a step size of <span
class="math inline">\alpha=\frac{1}{2}</span>. Show your work and
simplify your answer.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading10_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse10_2" aria-expanded="true" aria-controls="collapse10_2">
Click to view the solution.
</button>
</h2>
<div id="collapse10_2" class="accordion-collapse collapse"
aria-labelledby="heading10_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>First, we calculate the derivative of <span class="math inline">R(h)</span>. Using the chain rule, we have <span class="math display">\begin{align*} R(h) &amp;= \dfrac1n \sum_{i=1}^n
e^{(h-y_i)^2} \\
R'(h) &amp;= \dfrac1n \sum_{i=1}^n e^{(h-y_i)^2}\cdot 2(h-y_i) \\
\end{align*}</span> To apply the gradient descent update rule, we next
have to calculate <span class="math inline">R'(h_0)</span> or <span class="math inline">R'(2)</span>. Plugging in <span class="math inline">h=2</span> to the derivative we calculated above
gives: <span class="math display">\begin{align*}
R'(2) &amp;= \dfrac1n \sum_{i=1}^n e^{(2-y_i)^2}\cdot 2(2-y_i)
\end{align*}</span></p>
<p>The table below records the necessary information (note that we’ve
done most of the work already).</p>
<div>
<table>
<colgroup>
<col style="width: 54%"/>
<col style="width: 12%"/>
<col style="width: 14%"/>
<col style="width: 18%"/>
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">y_i</span>             </th>
<th>1</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">2-y_i</span></td>
<td>1</td>
<td>-1</td>
<td>-2</td>
</tr>
<tr class="even">
<td><span class="math inline">(2-y_i)^2</span></td>
<td>1</td>
<td>1</td>
<td>4</td>
</tr>
<tr class="odd">
<td><span class="math inline">e^{(2-y_i)^2}</span></td>
<td><span class="math inline">e</span></td>
<td><span class="math inline">e</span></td>
<td><span class="math inline">e^4</span></td>
</tr>
<tr class="even">
<td><span class="math inline">e^{(2-y_i)^2}\cdot 2(2-y_i)</span></td>
<td><span class="math inline">2e</span></td>
<td><span class="math inline">-2e</span></td>
<td><span class="math inline">-4e^4</span></td>
</tr>
</tbody>
</table>
</div>
<p><br/></p>
<p>Therefore: <span class="math display">\begin{aligned} R'(2)
&amp;= \dfrac{1}{3} \sum_{i=1}^{3} e^{(2-y_i)^2\cdot 2(2-y_i)} \\ &amp;=
\frac13 (2e - 2e -4e^4) \\ &amp;= \frac{-4e^4}{3}. \end{aligned}</span>
Applying the gradient descent update rule gives: <span class="math display">\begin{aligned} h_1 &amp;= h_0 - \alpha\cdot
R'(h_0) \\ &amp;= 2 - \frac{1}{2}\cdot \frac{-4e^4}{3} \\ &amp;= 2 +
\frac{2e^4}{3} \end{aligned}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-11">Problem 11</h2>
<p><i>Originally Problem 3 on the Winter 2024 Final Part 1</i></p>
<p>Suppose there is a dataset contains four values: <span
class="math inline">-2</span>, <span class="math inline">-1</span>,
<span class="math inline">2</span>, <span class="math inline">4</span>.
You would like to use gradient descent to minimize the mean square error
over this dataset.</p>
<p><br></p>
<h3 id="problem-11.1">Problem 11.1</h3>
<p>Write down the expression of mean square error and its derivative
given this dataset.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_1" aria-expanded="true" aria-controls="collapse11_1">
Click to view the solution.
</button>
</h2>
<div id="collapse11_1" class="accordion-collapse collapse"
aria-labelledby="heading11_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">R_{sq}(h) =
\frac{1}{4}\sum_{i=1}^{4}(y_i-h)^2</span></p>
<p>Recall the equation for <span class="math inline">R_{sq}(h) =
\frac{1}{n}\sum_{i=1}^{n}(y_i-h)^2</span>, so we simply need to replace
<span class="math inline">n</span> with <span class="math inline">4</span> because there are <span class="math inline">4</span> elements in our dataset.</p>
<p><span class="math inline">\frac{dR_{sq}(h)}{dh} =
\frac{1}{2}\sum_{i=1}^{4}(h-y_i)</span></p>
<p>Since we have the equation for <span class="math inline">R_{sq}(h)</span> we can calculate the
derivative:</p>
<p><span class="math display">
\begin{align*}
\frac{dR_{sq}(h)}{dh} &amp;=
\frac{dR_{sq}(h)}{dh}(\frac{1}{4}\sum_{i=1}^{4}(y_i-h)^2) \\
&amp;= \frac{1}{4}\sum_{i=1}^{4}\frac{dR_{sq}(h)}{dh}((y_i-h)^2) \\
\end{align*}
</span> We can use the chain rule to find the derivative of <span class="math inline">(y_i-h)^2</span>. Recall the chain rule is: <span class="math inline">\frac{df(x)}{dx}[(f(x))^n] = n(f(x))^{n-1} \cdot
f'(x)</span>.</p>
<p><span class="math display">
\begin{align*}
&amp;= \frac{1}{4}\sum_{i=1}^{4}2(y_i-h) \cdot -1 \\
&amp;= \frac{1}{4}\sum_{i=1}^{4} 2(h - y_i) \\
&amp;= \frac{1}{2}\sum_{i=1}^{4} (h-y_i)
\end{align*}
</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-11.2">Problem 11.2</h3>
<p>Suppose you choose the initial position to be <span
class="math inline">h_0</span> and the learning rate to be <span
class="math inline">\frac{1}{4}</span>. After two gradient descent
steps, <span class="math inline">h_2=\frac{1}{4}</span>. What is the
value of <span class="math inline">h_0</span>?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_2" aria-expanded="true" aria-controls="collapse11_2">
Click to view the solution.
</button>
</h2>
<div id="collapse11_2" class="accordion-collapse collapse"
aria-labelledby="heading11_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">h_{0} = -\frac{5}{4}</span></p>
<p>The gradient descent equation is given by: <span class="math display">\begin{aligned}
    h_i = h_{i-1} - \alpha \frac{dR_{sq}(h_{i-1})}{dh}
\end{aligned}</span> Recall the learning rate is equal to <span class="math inline">\alpha</span>. We can plug in <span class="math inline">\alpha = \frac{1}{4}</span>, <span class="math inline">h_2 = \frac{1}{4}</span>, and <span class="math inline">i=2</span>, in that case we obtain: <span class="math display">\begin{aligned}
    \frac{1}{4} &amp;= h_{1} - \alpha \frac{dR_{sq}(h_{1})}{dh}\\
    &amp;= h_{1} - \alpha \frac{1}{2}\sum_{i=1}^{4}(h_1-y_i)\\
        &amp;= h_{1} - \frac{1}{8}(h_{1} + 2 + h_{1} + 1 + h_{1} - 2 +
h_{1} - 4)\\
        &amp;= h_{1} - \frac{1}{8}(4h_{1} -3)\\
\end{aligned}</span> Solving this equation, we obtain that <span class="math inline">h_{1} = -\frac{1}{4}</span>. We can then repeat this
step once more to obtain <span class="math inline">h_0</span>: <span class="math display">\begin{aligned}
    -\frac{1}{4} &amp;= h_{0} - \alpha \frac{dR_{sq}(h_{0})}{dh}\\
        &amp;= h_{0} - \frac{1}{4}(h_{0} + 2 + h_{0} + 1 + h_{0} - 2 +
h_{0} - 4)\\
        &amp;= h_{0} - \frac{1}{8}(4h_{0} -3)\\
\end{aligned}</span> Solving this equation, we obtain that <span class="math inline">h_{0} = -\frac{5}{4}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-11.3">Problem 11.3</h3>
<p>Given that we set the tolerance of gradient descent to be <span
class="math inline">0.1</span>. How many <strong>additional
steps</strong> beyond <span class="math inline">h_2</span> do we need to
take to reach convergence?</p>
<ul class="task-list">
<li><p><input type="radio" disabled="" /> 0</p></li>
<li><p><input type="radio" disabled="" /> 1</p></li>
<li><p><input type="radio" disabled="" /> 2</p></li>
<li><p><input type="radio" disabled="" /> 3</p></li>
<li><p><input type="radio" disabled="" /> 4</p></li>
<li><p><input type="radio" disabled="" /> It will never converge</p></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_3" aria-expanded="true" aria-controls="collapse11_3">
Click to view the solution.
</button>
</h2>
<div id="collapse11_3" class="accordion-collapse collapse"
aria-labelledby="heading11_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">2</span> or <span class="math inline">3</span> additional steps (both are correct).</p>
<p>The gradient descent equation is given by: <span class="math display">\begin{aligned}
    h_i = h_{i-1} - \alpha \frac{dR_{sq}(h_{i-1})}{dh}
\end{aligned}</span> Now we start from <span class="math inline">\alpha
= \frac{1}{4}</span>, <span class="math inline">h_2 =
\frac{1}{4}</span>, and <span class="math inline">i=2</span>, in that
case we obtain: <span class="math display">\begin{aligned}
    h_{3} &amp;= h_{2} - \alpha \frac{dR_{sq}(h_{2})}{dh}\\
    &amp;= h_{2} - \frac{1}{8}(4h_{2} -3)\\
    &amp;= \frac{1}{4} - \frac{1}{8}(1 -3)\\
    &amp;= \frac{1}{2}\\
\end{aligned}</span> Iteratively, we have: <span class="math display">\begin{aligned}
    h_{4} &amp;= h_{3} - \alpha \frac{dR_{sq}(h_{3})}{dh}\\
    &amp;= h_{3} - \frac{1}{8}(4h_{3} -3)\\
    &amp;= \frac{1}{2} - \frac{1}{8}(2 -3)\\
    &amp;= \frac{5}{8}\\
\end{aligned}</span> <span class="math display">\begin{aligned}
    h_{5} &amp;= h_{4} - \alpha \frac{dR_{sq}(h_{4})}{dh}\\
    &amp;= h_{3} - \frac{1}{8}(4h_{4} -3)\\
    &amp;= \frac{5}{8} - \frac{1}{8}(\frac{5}{2}-3)\\
    &amp;= \frac{11}{16}\\
\end{aligned}</span> from <span class="math inline">h_4</span> to <span class="math inline">h_5</span>, the change is smaller than the
tolerance. That means we need additional <span class="math inline">2</span> or <span class="math inline">3</span> steps
to reach convergence (depending on if you actually perform <span class="math inline">h_4</span> to <span class="math inline">h_5</span>,
so both <span class="math inline">2</span> and <span class="math inline">3</span> are considered correct answer).</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-12">Problem 12</h2>
<p><em>Originally Problem 2 on the first Winter 2024 Midterm
Exam.</em></p>
<p>Let <span class="math inline">R_{sq}(h)</span> represent the mean
squared error of a constant prediction <span
class="math inline">h</span> for a given dataset. For the dataset <span
class="math inline">\{3, y_{1}\}</span>, the graph of <span
class="math inline">R_{sq}(h)</span> has its minimum at the point <span
class="math inline">(5,r_{1})</span>. Find out the value of <span
class="math inline">y_{1}</span> and <span
class="math inline">r_{1}</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading12">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse12" aria-expanded="true" aria-controls="collapse12">
Click to view the solution.
</button>
</h2>
<div id="collapse12" class="accordion-collapse collapse"
aria-labelledby="heading12" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The mean squared error is written as: <span class="math display">\begin{align*}
        R_{sq}(h) = \frac{1}{n}\sum_{i=0}^{n}(y_{i}-h)^2    
\end{align*}</span></p>
<p>Since we only have two data points (<span class="math inline">n=2</span>), the equation simplifies to:</p>
<p><span class="math display">\begin{align*}
        R_{sq}(h) = \frac{1}{2}((y_{0}-h)^2+ (y_{1}-h)^2)    
\end{align*}</span></p>
<p>Taking the derivative with respect to <span class="math inline">h</span>, we have: <span class="math display">\begin{align*}
        \frac{dR_{sq}(h)}{dh} = -(y_{0}-h)- (y_{1}-h)    
\end{align*}</span></p>
<p>We know that the derivative has to be 0 at the local minima,
therefore at <span class="math inline">h=5</span>, we have:</p>
<p><span class="math display">\begin{align*}
        \frac{dR_{sq}(h)}{dh} = -(3-5)- (y_{1}-5) &amp;= 0\\
        % -2+y_1-5 &amp;=0\\
        y_1 &amp;= 7
\end{align*}</span></p>
<p>So we know that the dataset is <span class="math inline">\{3,7\}</span>. Given all these information, we can
calculate <span class="math inline">r_1</span> with:</p>
<p><span class="math display">\begin{align*}
        R_{sq}(5) &amp;= \frac{1}{2}((y_{0}-5)^2+ (y_{1}-5)^2)\\
        &amp;=\frac{1}{2}((3-5)^2+ (7-5)^2)\\
        &amp;=\frac{1}{2}(4+4)=4
\end{align*}</span></p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion?
<a href="https://forms.gle/WZ71FchnXU1K154d7">Let us know
here</u></a>.</h4>
<hr />
</body>
</html>
