<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Fall 2021 Final Exam</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="..\assets\theme.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Fall 2021 Final Exam</h1>
</header>
<p><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<!-- add after bootstrap.min.css -->
<link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css"/>
<!-- add after bootstrap.min.js or bootstrap.bundle.min.js -->
<script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script></p>
<!-- for difficulty gauges-->
<script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B947E6J6H4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B947E6J6H4');
</script>
<p><a href="../index.html">← return to practice.dsc40a.com</a></p>
<hr />
<p><strong>Instructor(s):</strong> Suraj Rampure</p>
<p>This exam was administered online. Students had <strong>180
minutes</strong> to take this exam.</p>
<hr />
<h2 id="problem-1">Problem 1</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 1</i></p>
<p>The mean of 12 non-negative numbers is 45. Suppose we remove 2 of
these numbers. What is the largest possible value of the mean of the
remaining 10 numbers? Show your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1" aria-expanded="true" aria-controls="collapse1">
Click to view the solution.
</button>
</h2>
<div id="collapse1" class="accordion-collapse collapse"
aria-labelledby="heading1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">54</span>.</p>
<p>To maximize the mean of the remaining 10 numbers, we want to minimize
the numbers that are removed. The smallest possible non-negative number
is 0, so to maximize the mean of the remaining 10, we should remove two
0s from the set of numbers. Recall that the sum of the 12 number set is
<span class="math inline">12 \cdot 45</span>; then, the maximum possible
mean of the remaining 10 is</p>
<p><span class="math display">\frac{12 \cdot 45 - 2 \cdot 0}{10} =
\frac{6}{5} \cdot 45 = 54</span></p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-2">Problem 2</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 2</i></p>
<p>Consider a set of 8 data points, <span class="math inline">y_1, y_2,
..., y_8</span> that are in sorted order, i.e. <span
class="math inline">y_1 &lt; y_2 &lt; ... &lt; y_8</span>. Suppose that
<span class="math inline">y_4 = 10</span>, <span class="math inline">y_5
= 14</span>, and <span class="math inline">y_6 = 22</span>. Recall that
mean absolute error, <span class="math inline">R_{abs}(h)</span>, is
defined as <span class="math inline">R_{abs}(h) = \frac{1}{n} \sum_{i =
1}^n |y_i - h|</span>. Suppose that <span
class="math inline">R_{abs}(11) = 9</span>.</p>
<p>What is <span class="math inline">R_{abs}(22)</span>? Show your
work.</p>
<p><em>Hint: Use the formula for the slope of <span
class="math inline">R</span> at <span
class="math inline">h</span>.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="true" aria-controls="collapse2">
Click to view the solution.
</button>
</h2>
<div id="collapse2" class="accordion-collapse collapse"
aria-labelledby="heading2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">R_{abs}(22) = 11</span></p>
<p>We can write the points given to us as:</p>
<p><span class="math display">y_1, y_2, y_3, 10, 14, 22, y_7,
y_8</span></p>
<p>Since there are an even number of data points, all values of <span class="math inline">h</span> between the middle two points minimize
<span class="math inline">R_{abs}(h)</span>. In this case, all values of
<span class="math inline">h</span> in the interval <span class="math inline">[10, 14]</span> minimize <span class="math inline">R_{abs}(h)</span> and, as a result, have the same
value of <span class="math inline">R_{abs}(h)</span>. Thus, <span class="math inline">R_{abs}(14) = R_{abs}(11) = 9</span>.</p>
<p>From lecture, we know that:</p>
<p><span class="math display">\text{slope of $R$ at $h$} = \frac{1}{n}
\left( \left(\text{\# points } &lt; h\right) - \left(\text{\# points }
&gt; h\right)\right)</span></p>
<p>We can use this formula to determine what to add to <span class="math inline">R_{abs}(14)</span> to get <span class="math inline">R_{abs}(22)</span>. Note that for values of <span class="math inline">h</span> in the interval <span class="math inline">(14, 22)</span>, the slope of <span class="math inline">R</span> at <span class="math inline">h</span> is
<span class="math inline">\frac{1}{8} (5 - 3) = \frac{1}{4}</span>. This
means that for every 1 unit we move to the right from <span class="math inline">h = 14</span> until we get to <span class="math inline">h = 22</span>, <span class="math inline">R_{abs}(h)</span> increases by <span class="math inline">\frac{1}{4}</span>. So,</p>
<p><span class="math display">R_{abs}(22) = R_{abs}(14) + (22 - 14)
\cdot \frac{1}{4} = 9 + 2 = 11</span></p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-3">Problem 3</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 3</i></p>
<p>Consider the function <span class="math display">R(h) = (h -
2)^3</span></p>
<p>Suppose we want to try and minimize <span
class="math inline">R(h)</span> using gradient descent. We choose an
initial guess of <span class="math inline">h_0 = 1</span> and a step
size of <span class="math inline">\alpha = 1</span>.</p>
<p>Run the gradient descent algorithm twice, i.e. determine <span
class="math inline">h_1</span> and <span class="math inline">h_2</span>.
Show your work. Also, state whether or not gradient descent will
eventually find the minimizing value of <span
class="math inline">h</span>, given the specified <span
class="math inline">h_0</span> and <span
class="math inline">\alpha</span>.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3" aria-expanded="true" aria-controls="collapse3">
Click to view the solution.
</button>
</h2>
<div id="collapse3" class="accordion-collapse collapse"
aria-labelledby="heading3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">h_1 = -2</span>, <span class="math inline">h_2 = -50</span></p>
<p>No, gradient descent will not converge; <span class="math inline">h_i</span> will keep getting larger and more
negative (i.e. it tends to negative infinity).</p>
<p><span class="math display">\frac{dR}{dh} R(h) = 3 (h -
2)^2</span></p>
<p><span class="math display">\begin{align*}
    h_1 &amp;= h_0 - \alpha \cdot \frac{dR}{dh} R(h_0) \\
    &amp;= 1 - 3(1 - 2)^2 \\
    &amp;= -2
\end{align*}</span></p>
<p><span class="math display">\begin{align*}
    h_2 &amp;= h_1 - \alpha \cdot \frac{dR}{dh} R(h_1) \\
    &amp;= -2 - 3(-2 - 2)^2 \\
    &amp;= -2 - 48 \\
    &amp;= -50
\end{align*}</span></p>
</div>
</div>
</div>
</div>
<hr />
<h2 id="problem-4">Problem 4</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 4</i></p>
<p>You may find the following properties of logarithms helpful in this
question. Assume that all logarithms in this question are natural
logarithms, i.e. of base <span class="math inline">e</span>.</p>
<ul>
<li><span class="math inline">e^{\log(x)} = x</span></li>
<li><span class="math inline">\log(a) + \log(b) = \log(a \cdot
b)</span></li>
<li><span class="math inline">\log(a) - \log(b) = \log \left(
\frac{a}{b} \right)</span></li>
<li><span class="math inline">\log(a^c) = c \log (a)</span></li>
<li><span class="math inline">\frac{d}{dx} \log x =
\frac{1}{x}</span></li>
</ul>
<p>Billy, the avocado-farmer-turned-waiter-turned-Instagram-influencer
that you’re all-too-familiar with, is trying his hand at coming up with
loss functions. He comes up with the Billy loss, <span
class="math inline">L_B(h, y)</span>, defined as follows:</p>
<p><span class="math display">L_B(h, y) = \left[ \log \left( \frac{y}{h}
\right) \right]^2</span></p>
<p>Throughout this problem, assume that all <span
class="math inline">y</span>s are positive.</p>
<p><br></p>
<h3 id="problem-4.1">Problem 4.1</h3>
<p>Show that: <span class="math display">\frac{d}{dh} L_B(h, y) = -
\frac{2}{h} \log \left( \frac{y}{h} \right)</span></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_1" aria-expanded="true" aria-controls="collapse4_1">
Click to view the solution.
</button>
</h2>
<div id="collapse4_1" class="accordion-collapse collapse"
aria-labelledby="heading4_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\begin{align*}
    \frac{d}{dh} L_B(h, y) &amp;= \frac{d}{dh} \left[ \log \left(
\frac{y}{h} \right) \right]^2 \\
    &amp;= 2 \cdot \log \left( \frac{y}{h} \right) \cdot \frac{d}{dh}
\log \left( \frac{y}{h} \right) \\
    &amp;= 2 \cdot \log \left( \frac{y}{h} \right) \cdot \frac{d}{dh}
\left( \log(y) - \log(h) \right) \\
    &amp;= 2 \cdot \log \left( \frac{y}{h} \right) \cdot \left( -
\frac{1}{h} \right) \\
    &amp;= -\frac{2}{h} \log \left( \frac{y}{h} \right)
\end{align*}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-4.2">Problem 4.2</h3>
<p>Show that the constant prediction <span
class="math inline">h^*</span> that minimizes for Billy loss is:</p>
<p><span class="math display">h^* = \left(y_1 \cdot y_2 \cdot ... \cdot
y_n \right)^{\frac{1}{n}}</span></p>
<p>You do not need to perform a second derivative test, but otherwise
you must show your work.</p>
<p><em>Hint: To confirm that you’re interpreting the result correctly,
<span class="math inline">h^*</span> for the dataset 3, 5, 16 is <span
class="math inline">(3 \cdot 5 \cdot 16)^{\frac{1}{3}} =
240^{\frac{1}{3}} \approx 6.214</span>.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading4_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4_2" aria-expanded="true" aria-controls="collapse4_2">
Click to view the solution.
</button>
</h2>
<div id="collapse4_2" class="accordion-collapse collapse"
aria-labelledby="heading4_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\begin{align*}
    R_B(h) &amp;= \frac{1}{n} \sum_{i = 1}^n \left[ \log \left(
\frac{y_i}{h} \right) \right]^2 \\
\frac{d}{dh} R_B(h) &amp;= \frac{1}{n} \sum_{i = 1}^n \frac{d}{dh}
\left[ \log \left( \frac{y_i}{h} \right) \right]^2 \\
&amp;= \frac{1}{n} \sum_{i = 1}^n -\frac{2}{h} \log \left( \frac{y_i}{h}
\right) \\
&amp;= -\frac{2}{nh} \sum_{i = 1}^n \log \left( \frac{y_i}{h} \right) =
0 \\
0 &amp;= \sum_{i = 1}^n \log \left( \frac{y_i}{h} \right) = \sum_{i =
1}^n \left( \log(y_i) - \log(h)\right) \\
0 &amp;= \sum_{i = 1}^n \log(y_i) - \log(h) \sum_{i = 1}^n 1 \\
0 &amp;= \left( \log(y_1) + \log(y_2) + ... + \log(y_n) \right) - n
\log(h) \\
\log(h^n) &amp;= \log(y_1 \cdot y_2 \cdot ... \cdot y_n) \\
h^n &amp;= y_1 \cdot y_2 \cdot ... \cdot y_n \\
h^* &amp;= (y_1 \cdot y_2 \cdot ... \cdot y_n)^{\frac{1}{n}}
\end{align*}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-5">Problem 5</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 5</i></p>
<p>Suppose we have a dataset of <span class="math inline">n</span>
houses that were recently sold in the San Diego area. For each house, we
have its square footage and most recent sale price. The correlation
between square footage and price is <span
class="math inline">r</span>.</p>
<p><br></p>
<h3 id="problem-5.1">Problem 5.1</h3>
<p>First, we minimize mean squared error to fit a linear prediction rule
that uses square footage to predict price. The resulting prediction rule
has an intercept of <span class="math inline">w_0^*</span> and slope of
<span class="math inline">w_1^*</span>. In other words,</p>
<p><span class="math display">\text{predicted price} = w_0^* + w_1^*
\cdot \text{square footage}</span></p>
<p>We’re now interested in minimizing mean squared error to fit a linear
prediction rule <strong>that uses price to predict square
footage</strong>. Suppose this new regression line has an intercept of
<span class="math inline">\beta_0^*</span> and slope of <span
class="math inline">\beta_1^*</span>.</p>
<p>What is <span class="math inline">\beta_1^*</span>? Give your answer
in terms of one or more of <span class="math inline">n</span>, <span
class="math inline">r</span>, <span class="math inline">w_0^*</span>,
and <span class="math inline">w_1^*</span>. Show your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_1" aria-expanded="true" aria-controls="collapse5_1">
Click to view the solution.
</button>
</h2>
<div id="collapse5_1" class="accordion-collapse collapse"
aria-labelledby="heading5_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\beta_1^* = \frac{r^2}{w_1^*}</span></p>
<p>Throughout this solution, let <span class="math inline">x</span>
represent square footage and <span class="math inline">y</span>
represent price.</p>
<p>We know that <span class="math inline">w_1^* = r
\frac{\sigma_y}{\sigma_x}</span>. But what about <span class="math inline">\beta_1^*</span>?</p>
<p>When we take a rule that predicts price from square footage and
transform it into a rule that predicts square footage from price, the
roles of <span class="math inline">x</span> and <span class="math inline">y</span> have swapped; suddenly, square footage is
no longer our independent variable, but our dependent variable, and vice
versa for price. This means that the altered dataset we work with when
using our new prediction rule has <span class="math inline">\sigma_x</span> standard deviation for its dependent
variable (square footage), and <span class="math inline">\sigma_y</span>
for its independent variable (price). So, we can write the formula for
<span class="math inline">\beta_1^*</span> as follows: <span class="math display">\beta_1^* = r \frac{\sigma_x}{\sigma_y}</span></p>
<p>In essence, swapping the independent and dependent variables of a
dataset changes the slope of the regression line from <span class="math inline">r \frac{\sigma_y}{\sigma_x}</span> to <span class="math inline">r \frac{\sigma_x}{\sigma_y}</span>.</p>
<p>From here, we can use a little algebra to get our <span class="math inline">\beta_1^*</span> in terms of one or more <span class="math inline">n</span>, <span class="math inline">r</span>, <span class="math inline">w_0^*</span>, and <span class="math inline">w_1^*</span>:</p>
<p><span class="math display">\begin{align*}
\beta_1^* &amp;= r \frac{\sigma_x}{\sigma_y} \\
w_1^* \cdot \beta_1^* &amp;= w_1^* \cdot r \frac{\sigma_x}{\sigma_y} \\
w_1^* \cdot \beta_1^* &amp;= ( r \frac{\sigma_y}{\sigma_x}) \cdot r
\frac{\sigma_x}{\sigma_y}
\end{align*}</span></p>
<p>The fractions <span class="math inline">\frac{\sigma_y}{\sigma_x}</span> and <span class="math inline">\frac{\sigma_x}{\sigma_y}</span> cancel out and we
get:</p>
<p><span class="math display">\begin{align*}
w_1^* \cdot \beta_1^* &amp;= r^2 \\
\beta_1^* &amp;= \frac{r^2}{w_1^*}
\end{align*}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-5.2">Problem 5.2</h3>
<p><strong>For this part only</strong>, assume that the following
quantities hold:</p>
<ul>
<li><span class="math inline">n = 100</span></li>
<li><span class="math inline">r = 0.6</span></li>
<li><span class="math inline">w_0^* = 1000</span></li>
<li><span class="math inline">w_1^* = 250</span></li>
<li>The average square footage of homes in the dataset is 2000</li>
</ul>
<p>Given this information, what is <span
class="math inline">\beta_0^*</span>? Give your answer as a constant,
rounded to two decimal places. Show your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading5_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5_2" aria-expanded="true" aria-controls="collapse5_2">
Click to view the solution.
</button>
</h2>
<div id="collapse5_2" class="accordion-collapse collapse"
aria-labelledby="heading5_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\beta_0^* = 1278.56</span></p>
<p>We start with the formula for the intercept of the regression line.
Note that <span class="math inline">x</span> and <span class="math inline">y</span> are opposite what they’d normally be since
we’re using price to predict square footage.</p>
<p><span class="math display">\beta_0^* = \bar{x} - \beta_1^*
\bar{y}</span></p>
<p>We’re told that the average square footage of homes in the dataset is
2000, so <span class="math inline">\bar{x} = 2000</span>. We also know
from part (a) that <span class="math inline">\beta_1^* =
\frac{r^2}{w_1^*}</span>, and from the information given in this part
this is <span class="math inline">\beta_1^* = \frac{r^2}{w_1^*} =
\frac{0.6^2}{250}</span>.</p>
<p>Finally, we need the average price of all homes in the dataset, <span class="math inline">\bar{y}</span>. We aren’t given this information
directly, but we can use the fact that <span class="math inline">(\bar{x}, \bar{y})</span> are on the regression line
that uses square footage to predict price to find <span class="math inline">\bar{y}</span>. Specifically, we have that <span class="math inline">\bar{y} = w_0^* + w_1^* \bar{x}</span>; we know that
<span class="math inline">w_0^* = 1000</span>, <span class="math inline">\bar{x} = 2000</span>, and <span class="math inline">w_1^* = 250</span>, so <span class="math inline">\bar{y} = 1000 + 2000 \cdot 250 = 501000</span>.</p>
<p>Putting these pieces together, we have</p>
<p><span class="math display">
\begin{align*}
\beta_0^* &amp;= \bar{x} - \beta_1^* \bar{y} \\
&amp;= 2000 - \frac{0.6^2}{250} \cdot 501000 \\
&amp;= 2000 - 0.6^2 \cdot 2004 \\
&amp;= 1278.56
\end{align*}
</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-6">Problem 6</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 6</i></p>
<p>Billy’s aunt owns a jewellery store, and gives him data on <span
class="math inline">5000</span> of the diamonds in her store. For each
diamond, we have:</p>
<ul>
<li><strong>carat</strong>: the weight of the diamond, in carats</li>
<li><strong>length</strong>: the length of the diamond, in
centimeters</li>
<li><strong>width</strong>: the width of the diamond, in
centimeters</li>
<li><strong>price</strong>: the value of the diamond, in dollars</li>
</ul>
<p>The first 5 rows of the 5000-row dataset are shown below:</p>
<div>
<table>
<colgroup>
<col style="width: 24%" />
<col style="width: 27%" />
<col style="width: 24%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="header">
<th>carat   </th>
<th>length   </th>
<th>width   </th>
<th>price   </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.40</td>
<td>4.81</td>
<td>4.76</td>
<td>1323</td>
</tr>
<tr class="even">
<td>1.04</td>
<td>6.58</td>
<td>6.53</td>
<td>5102</td>
</tr>
<tr class="odd">
<td>0.40</td>
<td>4.74</td>
<td>4.76</td>
<td>696</td>
</tr>
<tr class="even">
<td>0.40</td>
<td>4.67</td>
<td>4.65</td>
<td>798</td>
</tr>
<tr class="odd">
<td>0.50</td>
<td>4.90</td>
<td>4.95</td>
<td>987</td>
</tr>
</tbody>
</table>
</div>
<p><br> Billy has enlisted our help in predicting the price of a diamond
given various other features.</p>
<p><br></p>
<h3 id="problem-6.1">Problem 6.1</h3>
<p>Suppose we want to fit a linear prediction rule that uses two
features, carat and length, to predict price. Specifically, our
prediction rule will be of the form</p>
<p><span class="math display">\text{predicted price} = w_0 + w_1 \cdot
\text{carat} + w_2 \cdot \text{length}</span></p>
<p><br></p>
<p>We will use least squares to find <span class="math inline">\vec{w}^*
= \begin{bmatrix} w_0^* \\ w_1^* \\ w_2^* \end{bmatrix}</span>.</p>
<p>Write out the first 5 rows of the design matrix, <span
class="math inline">X</span>. Your matrix should not have any variables
in it.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_1" aria-expanded="true" aria-controls="collapse6_1">
Click to view the solution.
</button>
</h2>
<div id="collapse6_1" class="accordion-collapse collapse"
aria-labelledby="heading6_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">X = \begin{bmatrix} 1 &amp; 0.40 &amp;
4.81 \\ 1 &amp; 1.04 &amp; 6.58 \\ 1 &amp; 0.40 &amp; 4.74 \\ 1 &amp;
0.40 &amp; 4.67 \\ 1 &amp; 0.50 &amp; 4.90 \end{bmatrix}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.2">Problem 6.2</h3>
<p>Suppose the optimal parameter vector <span
class="math inline">\vec{w}^*</span> is given by</p>
<p><span class="math display">\vec{w}^* = \begin{bmatrix} 2000 \\ 10000
\\ -1000 \end{bmatrix}</span></p>
<p>What is the predicted price of a diamond with 0.65 carats and a
length of 4 centimeters? Show your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_2" aria-expanded="true" aria-controls="collapse6_2">
Click to view the solution.
</button>
</h2>
<div id="collapse6_2" class="accordion-collapse collapse"
aria-labelledby="heading6_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>The predicted price is <span class="math inline">4500</span>
dollars.</p>
<p><span class="math display">2000 + 10000 \cdot 0.65 - 1000 \cdot 4 =
4500</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.3">Problem 6.3</h3>
<p>Suppose <span class="math inline">\vec{e} = \begin{bmatrix} e_1 \\
e_2 \\ ... \\ e_n \end{bmatrix}</span> is the error/residual vector,
defined as</p>
<p><span class="math display">\vec{e} = \vec{y} - X \vec{w}^*</span></p>
<p>where <span class="math inline">\vec{y}</span> is the observation
vector containing the prices for each diamond.</p>
<p>For each of the following quantities, state whether they are
guaranteed to be equal to 0 the scalar, <span
class="math inline">\vec{0}</span> the vector of all 0s, or neither. No
justification is necessary.</p>
<ul>
<li><span class="math inline">\sum_{i = 1}^n e_i</span></li>
<li><span class="math inline">|| \vec{y} - X \vec{w}^* ||^2</span></li>
<li><span class="math inline">X^TX \vec{w}^*</span></li>
<li><span class="math inline">2X^TX \vec{w}^* - 2X^T\vec{y}</span></li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_3" aria-expanded="true" aria-controls="collapse6_3">
Click to view the solution.
</button>
</h2>
<div id="collapse6_3" class="accordion-collapse collapse"
aria-labelledby="heading6_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ul>
<li><span class="math inline">\sum_{i = 1}^n e_i</span>:
<strong>Yes</strong>, this is guaranteed to be 0. This was discussed in
Homework 4; it is a consequence of the fact that <span class="math inline">X^T (y - X \vec{w}^*) = 0</span> and that we have an
intercept term in our prediction rule (and hence a column of all 1s in
our design matrix, <span class="math inline">X</span>).</li>
<li><span class="math inline">|| \vec{y} - X \vec{w}^* ||^2</span>:
<strong>No</strong>, this is not guaranteed to be 0. This is the mean
squared error of our prediction rule, multiplied by <span class="math inline">n</span>. <span class="math inline">\vec{w}^*</span>
is found by minimizing mean squared error, but the minimum value of mean
squared error isn’t necessarily 0 — in fact, this quantity is only 0 if
we can write <span class="math inline">\vec{y}</span> exactly as <span class="math inline">X \vec{w}^*</span> with no prediction errors.</li>
<li><span class="math inline">X^TX \vec{w}^*</span>:
<strong>No</strong>, this is not guaranteed to be 0, either.</li>
<li><span class="math inline">2X^TX \vec{w}^* - 2X^T\vec{y}</span>:
<strong>Yes</strong>, this is guaranteed to be 0. Recall, the optimal
parameter vector <span class="math inline">\vec{w}^*</span> satisfies
the normal equations <span class="math inline">X^TX\vec{w}^* = X^T
\vec{y}</span>. Subtracting <span class="math inline">X^T \vec{y}</span>
from both sides of this equation and multiplying both sides by 2 yields
the desired result. (You may also find <span class="math inline">2X^TX
\vec{w}^* - 2X^T\vec{y}</span> to be familiar from lecture — it is the
gradient of the mean squared error, multiplied by <span class="math inline">n</span>, and we set the gradient to 0 to find <span class="math inline">\vec{w}^*</span>.)</li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-6.4">Problem 6.4</h3>
<p>Suppose we introduce two more features:</p>
<ul>
<li>width alone, and</li>
<li>area, which is defined as length times width</li>
</ul>
<p>Suppose we also decide to remove the intercept term of our prediction
rule. With all of these changes, our prediction rule is now</p>
<p><span class="math display">\text{predicted price} = w_1 \cdot
\text{carat} + w_2 \cdot \text{length} + w_3 \cdot \text{width} + w_4
\cdot (\text{length} \cdot \text{width}) </span></p>
<ul>
<li>Write out just the first 2 rows of the design matrix <span
class="math inline">X</span> for this new prediction rule. You do
<strong>not</strong> need to simplify the numbers in your matrix, it is
fine if they involve the multiplication symbol.</li>
<li>Is the optimal coefficient for carat, <span
class="math inline">w_1^*</span>, for this new prediction rule
guaranteed to be equal to 10000, the optimal coefficient for carat in
our original prediction rule? No justification is necessary.</li>
</ul>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading6_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6_4" aria-expanded="true" aria-controls="collapse6_4">
Click to view the solution.
</button>
</h2>
<div id="collapse6_4" class="accordion-collapse collapse"
aria-labelledby="heading6_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<ul>
<li><span class="math inline">X = \begin{bmatrix} 0.40 &amp; 4.81 &amp;
4.76 &amp; 4.81 \cdot 4.76 \\ 1.04 &amp; 6.58 &amp; 6.53 &amp; 6.58
\cdot 6.53 \end{bmatrix}</span></li>
<li>No, it’s not guaranteed that the <span class="math inline">\vec{w}_1^*</span> for this new prediction rule is
equal to the <span class="math inline">\vec{w}_1^*</span> for the
original prediction rule. The value of <span class="math inline">\vec{w}_1^*</span> in the new prediction rule will
be influenced by the fact that there’s no longer an intercept term and
that there are two new features (width and area) that weren’t previously
there.</li>
</ul>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-7">Problem 7</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 7</i></p>
<p>Consider the following dataset of 7 points.</p>
<center><img src="../assets/images/fa21-final/k-means.png" width="500"></center>
<p>Suppose we want to identify <span class="math inline">k=2</span>
clusters in this dataset using <span class="math inline">k</span>-Means
Clustering.</p>
<p><br></p>
<h3 id="problem-7.1">Problem 7.1</h3>
<p>Determine the centroids <span class="math inline">\vec{\mu}_1</span>
and <span class="math inline">\vec{\mu}_2</span> that minimize inertia.
(Let <span class="math inline">\vec{\mu}_1</span> be the centroid with a
smaller <span class="math inline">x_1</span> coordinate.) Justify your
answers.</p>
<p><em>Note: You don’t have to run the k-Means Clustering algorithm to
answer this question.</em></p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_1" aria-expanded="true" aria-controls="collapse7_1">
Click to view the solution.
</button>
</h2>
<div id="collapse7_1" class="accordion-collapse collapse"
aria-labelledby="heading7_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">\vec{\mu}_1 = \begin{bmatrix} 3 \\ 9
\end{bmatrix}, \vec{\mu}_2 = \begin{bmatrix} 8 \\ 2
\end{bmatrix}</span></p>
<p>It’s clear that there are two clusters — one in the top left, and one
in the bottom right.</p>
<p>To find <span class="math inline">\vec{\mu}_1</span>, the centroid
for the top-left cluster, we take the mean of four points assigned to
cluster 1, giving</p>
<p><span class="math display">\vec{\mu}_1 = \frac{1}{4} \left(
\begin{bmatrix} 2 \\ 8 \end{bmatrix} + \begin{bmatrix} 4 \\ 8
\end{bmatrix} + \begin{bmatrix} 2 \\ 10 \end{bmatrix} + \begin{bmatrix}
4 \\ 10 \end{bmatrix} \right) = \begin{bmatrix} 3 \\ 9
\end{bmatrix}</span></p>
<p>You can also arrive at this result without any algebra by taking the
middle of the ‘square’.</p>
<p>To find <span class="math inline">\vec{\mu}_2</span>, the centroid
for the bottom-right cluster, we take the mean of three points assigned
to cluster 2, giving</p>
<p><span class="math display">\vec{\mu}_2 = \frac{1}{3} \left(
\begin{bmatrix} 7 \\ 1 \end{bmatrix} + \begin{bmatrix} 8 \\ 4
\end{bmatrix} + \begin{bmatrix} 9 \\ 1 \end{bmatrix}  \right) =
\begin{bmatrix} 8 \\ 2 \end{bmatrix}</span></p>
<p>Thus,</p>
<p><span class="math display">\vec{\mu}_1 = \begin{bmatrix} 3 \\ 9
\end{bmatrix}, \vec{\mu}_2 = \begin{bmatrix} 8 \\ 2
\end{bmatrix}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-7.2">Problem 7.2</h3>
<p>What is the total inertia for the centroids you chose in part (a)?
Show your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading7_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7_2" aria-expanded="true" aria-controls="collapse7_2">
Click to view the solution.
</button>
</h2>
<div id="collapse7_2" class="accordion-collapse collapse"
aria-labelledby="heading7_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math inline">16</span>.</p>
<p>We’ll proceed by determining the inertia of each cluster individually
and adding the results together.</p>
<p>First, let’s consider the top-left cluster, whose centroid is at
<span class="math inline">\begin{bmatrix} 3 \\ 9 \end{bmatrix}</span>.
The squared distance between the centroid and each of the four points in
the cluster individually is <span class="math inline">1^2 + 1^2 =
2</span>. It’s easiest to see this by drawing a picture, but we can
calculate all squared distances algebraically as well:</p>
<ul>
<li><p><span class="math inline">\begin{bmatrix} 2 \\ 8 \end{bmatrix} -
\begin{bmatrix} 3 \\ 9 \end{bmatrix} =
\begin{bmatrix} -1 \\ -1 \end{bmatrix} \implies \text{squared distance}
= (-1)^2 + (-1)^2 = 2</span></p></li>
<li><p><span class="math inline">\begin{bmatrix} 4 \\ 8 \end{bmatrix} -
\begin{bmatrix} 3 \\ 9 \end{bmatrix} =
\begin{bmatrix} 1 \\ -1 \end{bmatrix} \implies \text{squared distance} =
(1)^2 + (-1)^2 = 2</span></p></li>
<li><p><span class="math inline">\begin{bmatrix} 2 \\ 10 \end{bmatrix} -
\begin{bmatrix} 3 \\ 9 \end{bmatrix} =
\begin{bmatrix} -1 \\ 1 \end{bmatrix} \implies \text{squared distance} =
(-1)^2 + (1)^2 = 2</span></p></li>
<li><p><span class="math inline">\begin{bmatrix} 4 \\ 10 \end{bmatrix} -
\begin{bmatrix} 3 \\ 9 \end{bmatrix} =
\begin{bmatrix} 1 \\ 1 \end{bmatrix} \implies \text{squared distance} =
(1)^2 + (1)^2 = 2</span></p></li>
</ul>
<p>Thus, the inertia for cluster 1 is <span class="math inline">2 + 2 +
2 + 2 = 8</span>.</p>
<p>We follow a similar procedure for cluster 2:</p>
<ul>
<li><p><span class="math inline">\begin{bmatrix} 7 \\ 1 \end{bmatrix} -
\begin{bmatrix} 8 \\ 2 \end{bmatrix} =
\begin{bmatrix} -1 \\ -1 \end{bmatrix} \implies \text{squared distance}
= (-1)^2 + (-1)^2 = 2</span></p></li>
<li><p><span class="math inline">\begin{bmatrix} 8 \\ 4 \end{bmatrix} -
\begin{bmatrix} 8 \\ 2 \end{bmatrix} =
\begin{bmatrix} 0 \\ 2 \end{bmatrix} \implies \text{squared distance} =
(0)^2 + (2)^2 = 4</span></p></li>
<li><p><span class="math inline">\begin{bmatrix} 9 \\ 1 \end{bmatrix} -
\begin{bmatrix} 8 \\ 2 \end{bmatrix} =
\begin{bmatrix} 1 \\ -1 \end{bmatrix} \implies \text{squared distance} =
(-1)^2 + (1)^2 = 2</span></p></li>
</ul>
<p>Thus, the inertia for cluster 2 is <span class="math inline">2 + 4 +
2 = 8</span>.</p>
<p>This means that the total inertia for the whole dataset is <span class="math inline">8 + 8 = 16</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-8">Problem 8</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 8</i></p>
<p>Billy brings you back to Dirty Birds, the restaurant where he is a
waiter. He tells you that Dirty Birds has 30 different flavors of
chicken wings, 18 of which are ‘wet’ (e.g. honey garlic) and 12 of which
are ‘dry’ (e.g. lemon pepper).</p>
<p>Each time you place an order at Dirty Birds, you get to pick 4
different flavors. The order in which you pick your flavors does not
matter.</p>
<p><strong>Note:</strong> In this problem, you may leave your answers in
terms of <span class="math inline">{n \choose k}</span>, <span
class="math inline">P(n, k)</span>, and/or factorials. However, you must
provide a one-sentence explanation for your answer in each subpart.</p>
<p><br></p>
<h3 id="problem-8.1">Problem 8.1</h3>
<p>How many ways can we select 4 flavors in total?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_1" aria-expanded="true" aria-controls="collapse8_1">
Click to view the solution.
</button>
</h2>
<div id="collapse8_1" class="accordion-collapse collapse"
aria-labelledby="heading8_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">{30 \choose 4}</span></p>
<p>There are 30 total flavors and we want to select 4 such that order
does not matter. In this subpart we don’t care about whether our flavors
are dry or wet.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-8.2">Problem 8.2</h3>
<p>How many ways can we select 4 flavors such that we select an equal
number of wet and dry flavors?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_2" aria-expanded="true" aria-controls="collapse8_2">
Click to view the solution.
</button>
</h2>
<div id="collapse8_2" class="accordion-collapse collapse"
aria-labelledby="heading8_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">{18 \choose 2}{12 \choose 2}</span></p>
<p>To select an equal number of wet and dry flavors, we need to select 2
wet flavors and 2 dry flavors. There are 18 wet flavors, so there are
<span class="math inline">{18 \choose 2}</span> ways to select 2 of
them. Similarly, there are <span class="math inline">{12 \choose
2}</span> ways to select 2 of the 12 dry flavors. We need to select 18
wet flavors AND 12 dry flavors, so we multiply these numbers.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-8.3">Problem 8.3</h3>
<p>Billy tells you he’ll surprise you with 4 different flavors, randomly
selected from the 30 flavors available. What’s the probability that he
brings you at least one wet flavor and and least one dry flavor?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_3" aria-expanded="true" aria-controls="collapse8_3">
Click to view the solution.
</button>
</h2>
<div id="collapse8_3" class="accordion-collapse collapse"
aria-labelledby="heading8_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">1 - \frac{{18 \choose 4}}{{30 \choose 4}}
- \frac{{12 \choose 4}}{{30 \choose 4}}</span></p>
<p>Note that the event “Billy brings you at least one wet flavor and at
least one dry flavor” is the complement of the event “Billy brings you
only wet flavors or only dry flavors”. Thus, we can find the probability
that Billy brings you only wet flavors or only dry flavors and subtract
it from 1, using the complement rule.</p>
<p>To find the probability that Billy brings you only wet flavors, we
first count the number of ways to select 4 wet flavors from 18; this is
<span class="math inline">{18 \choose 4}</span>. The total number of
ways of selecting 4 flavors is <span class="math inline">{30 \choose
4}</span>, hence the probability that he brings you only wet flavors is
<span class="math inline">\frac{{18 \choose 4}}{{30 \choose 4}}</span>.
Similarly, the probability he brings you only dry flavors is <span class="math inline">\frac{{18 \choose 4}}{{30 \choose 4}}</span>. Since
the events “Billy brings you only wet flavors” and “Billy brings you
only dry flavors” are mutually exclusive, we can add these probabilities
to find the probability of the event “Billy brings you only wet flavors
or only dry flavors”, yielding <span class="math inline">\frac{{18
\choose 4}}{{30 \choose 4}} + \frac{{12 \choose 4}}{{30 \choose
4}}</span>. We subtract this number from 1 to get the desired
result.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-8.4">Problem 8.4</h3>
<p>Suppose you go to Dirty Birds once a day for 7 straight days. Each
time you go there, Billy brings you 4 different flavors, randomly
selected from the 30 flavors available. What’s the probability that on
at least one of the 7 days, he brings you all wet flavors or all dry
flavors? (<em>Note: All 4 flavors for a particular day must be
different, but it is possible to get the same flavor on multiple
days.</em>)</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading8_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8_4" aria-expanded="true" aria-controls="collapse8_4">
Click to view the solution.
</button>
</h2>
<div id="collapse8_4" class="accordion-collapse collapse"
aria-labelledby="heading8_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">1 - \left[1 - \frac{{18 \choose 4}}{{30
\choose 4}} - \frac{{12 \choose 4}}{{30 \choose 4}} \right]^7</span></p>
<p>Note that the event “at least once, Billy brings you all wet or all
dry wings” is the complement of the event “Billy never brings you all
wet or all dry wings.” This new event is equivalent to “Billy always
brings you at least one wet flavor and at least one dry flavor.”</p>
<p>In part (c), we found that for one particular day, the probability
that Billy brings you at least one wet flavor and at least one dry
flavor is <span class="math display">1 - \frac{{18 \choose 4}}{{30
\choose 4}} - \frac{{12 \choose 4}}{{30 \choose 4}}.</span> Each day the
flavors “reset” (we are told that flavors can be chosen on multiple
days), and so this probability is the same for each of the 7 days. This
makes the probability that he brings us at least one wet flavor and at
least one dry flavor on all 7 days <span class="math inline">\left[1 -
\frac{{18 \choose 4}}{{30 \choose 4}} - \frac{{12 \choose 4}}{{30
\choose 4}} \right]^7</span>, and so the desired probability — the
probability that he brings us all wet flavors or all dry flavors on at
least one of the 7 days — is</p>
<p><span class="math display">1 - \left[1 - \frac{{18 \choose 4}}{{30
\choose 4}} - \frac{{12 \choose 4}}{{30 \choose 4}} \right]^7</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-9">Problem 9</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 9</i></p>
<p>In this question, we’ll consider the phone number 6789998212
(mentioned in Soulja Boy’s 2008 classic, “Kiss Me thru the Phone”).</p>
<p><strong>Note:</strong> In this problem, you may leave your answers in
terms of <span class="math inline">{n \choose k}</span>, <span
class="math inline">P(n, k)</span>, and/or factorials. However, you must
provide a one-sentence explanation for your answer in each subpart.</p>
<p><br></p>
<h3 id="problem-9.1">Problem 9.1</h3>
<p>How many permutations of 6789998212 are there?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9_1" aria-expanded="true" aria-controls="collapse9_1">
Click to view the solution.
</button>
</h2>
<div id="collapse9_1" class="accordion-collapse collapse"
aria-labelledby="heading9_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>There are <span class="math inline">{10 \choose 1}{9 \choose 1}{8
\choose 2}{6 \choose 3}{3 \choose 2}{1 \choose 1}</span>
permutations.</p>
<p>If all digits in 6789998212 were <em>unique</em>, there would be
<span class="math inline">10!</span> permutations. However, some of the
digits are repeated; for each repeated digit, we need to divide by the
number of ways to re-arrange the repeated digits amongst themselves.</p>
<p>Let’s count the number of occurrences of each digit.</p>
<ul>
<li>6: 1 occurrence</li>
<li>7: 1 occurrence</li>
<li>8: 2 occurrences</li>
<li>9: 3 occurrences</li>
<li>2: 2 occurrences</li>
<li>1: 1 occurrence</li>
</ul>
<p>Thus, the number of permutations of 6789998212 is</p>
<p><span class="math display">\frac{10!}{2! 3! 2!}</span></p>
<p>Another way to arrive at this result is by saying first, we need to
choose 1 of the 10 positions to contain a 1. Then, we need to choose 1
of the remaining 9 positions to contain a 7. Then, we need to choose 2
of the remaining 8 positions to contain a 8, and so on and so forth.
This method yields</p>
<p><span class="math display">{10 \choose 1}{9 \choose 1}{8 \choose 2}{6
\choose 3}{3 \choose 2}{1 \choose 1}</span></p>
<p>If you expand out this result, you’ll see that it’s equal to the
first result. You may also notice that this is equivalent to <span class="math inline">{10 \choose 3}{7 \choose 2}{5 \choose 2}{3 \choose
1}{2 \choose 1}{1 \choose 1}</span>, which follows the same approach but
chooses locations for the repeated characters first.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-9.2">Problem 9.2</h3>
<p>How many permutations of 6789998212 have all three 9s next to each
other?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9_2" aria-expanded="true" aria-controls="collapse9_2">
Click to view the solution.
</button>
</h2>
<div id="collapse9_2" class="accordion-collapse collapse"
aria-labelledby="heading9_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>There are <span class="math inline">\displaystyle
\frac{8!}{2!2!}</span> permutations.</p>
<p>The key insight here is that we can treat all three 9s as being just
a single character, X, and determine the number of permutations of the
8-character string 678X8212. To do so, we again count the number of
occurrences of each digit:</p>
<ul>
<li>6: 1 occurrence</li>
<li>7: 1 occurrence</li>
<li>8: 2 occurrences</li>
<li>X: 1 occurrence</li>
<li>2: 2 occurrences</li>
<li>1: 1 occurrence</li>
</ul>
<p>Thus, the number of permutations of 6789998212 with all 3 9s
appearing together is</p>
<p><span class="math display">\frac{8!}{2!2!}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-9.3">Problem 9.3</h3>
<p>How many permutations of 6789998212 end with a 1 and start with a
6?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9_3">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9_3" aria-expanded="true" aria-controls="collapse9_3">
Click to view the solution.
</button>
</h2>
<div id="collapse9_3" class="accordion-collapse collapse"
aria-labelledby="heading9_3" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>There are <span class="math inline">\displaystyle \frac{8!}{2! 3!
2!}</span> permutations.</p>
<p>Similarly to the previous part, we can “fix” the 1 at the start and 6
at the end. All we really need to determine is the number of
permutations of 78999822, which is</p>
<p><span class="math display">\frac{8!}{2! 3! 2!}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-9.4">Problem 9.4</h3>
<p>How many different 3 digit numbers with unique digits can we create
by selecting digits from 6789998212?</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading9_4">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9_4" aria-expanded="true" aria-controls="collapse9_4">
Click to view the solution.
</button>
</h2>
<div id="collapse9_4" class="accordion-collapse collapse"
aria-labelledby="heading9_4" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>There are <span class="math inline">\displaystyle \frac{8!}{2! 3! 2!}
= 120</span> permutations.</p>
<p>The key here is that the 3 digit numbers that we’re creating must
have unique digits. There are 6 unique digits in 6789998212: 6, 7, 8, 9,
2, 1.</p>
<p>There are 6 options for the first digit of our 3 digit number, 5
options for the second digit, and 4 options for the third digit. Thus,
the number of 3 digit numbers we can create in this way is <span class="math inline">6 \cdot 5 \cdot 4 = 120</span>. This is also <span class="math inline">{6 \choose 3} \cdot {3!}</span> (Choosing three
elements from six, multiplying by <span class="math inline">3!</span>
because order matters).</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-10">Problem 10</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 10</i></p>
<p>Suppose you’re given the following probabilities:</p>
<ul>
<li><span class="math inline">P(A | B) = \frac{2}{5}</span></li>
<li><span class="math inline">P(B | A) = \frac{1}{4}</span></li>
<li><span class="math inline">P(A | C) = \frac{2}{3}</span></li>
</ul>
<p><br></p>
<h3 id="problem-10.1">Problem 10.1</h3>
<p>If <span class="math inline">A</span> and <span
class="math inline">C</span> are independent, what is <span
class="math inline">P(B)</span>? Show your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading10_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse10_1" aria-expanded="true" aria-controls="collapse10_1">
Click to view the solution.
</button>
</h2>
<div id="collapse10_1" class="accordion-collapse collapse"
aria-labelledby="heading10_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">P(B) = \frac{5}{12}</span></p>
<p>If <span class="math inline">A</span> and <span class="math inline">C</span> are independent, then <span class="math inline">P(A) = P(A | C) = \frac{2}{3}</span>. Then, from
Bayes’ rule, we have</p>
<p><span class="math display">
\begin{align}
P(A | B) &amp;= \frac{P(A) P(B|A)}{P(B)} \\
\implies P(B) &amp;= \frac{P(A) P(B|A)}{P(A|B)}\\
&amp;= \frac{\frac{2}{3} \cdot \frac{1}{4}}{\frac{2}{5}} \\
&amp;= \frac{5}{12}
\end{align}
</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-10.2">Problem 10.2</h3>
<p>Suppose <span class="math inline">A</span> and <span
class="math inline">C</span> are not independent, and now suppose that
<span class="math inline">P(A | \overline{C}) = \frac{1}{5}</span>.
Given that <span class="math inline">A</span> and <span
class="math inline">B</span> are independent, what is <span
class="math inline">P(C)</span>? Show your work.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading10_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse10_2" aria-expanded="true" aria-controls="collapse10_2">
Click to view the solution.
</button>
</h2>
<div id="collapse10_2" class="accordion-collapse collapse"
aria-labelledby="heading10_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">P(C) = \frac{3}{7}</span></p>
<p>Since we’re given that <span class="math inline">A</span> and <span class="math inline">B</span> are independent, <span class="math inline">P(A) = P(A | B) = \frac{2}{5}</span>. By the Law of
Total Probability, we have</p>
<p><span class="math display">P(A) = P(A \cap C) + P(A \cap
\overline{C}) = P(C) P(A | C) + P(\overline{C}) P(A |
\overline{C})</span></p>
<p>For simplicity, let <span class="math inline">p = P(C)</span>. Then,
substituting in our known values <span class="math inline">P(A)</span>,
<span class="math inline">P(A | C)</span>, and <span class="math inline">P(A | \overline{C})</span> and solving for <span class="math inline">p</span> yields</p>
<p><span class="math display">\begin{align*}
    P(A) = P(A \cap C) + P(A \cap \overline{C}) &amp;= P(C) P(A | C) +
P(\overline{C}) P(A | \overline{C}) \\
    \frac{2}{5} &amp;= \frac{2}{3} p + \frac{1}{5} (1 - p) \\
    \frac{2}{5} &amp;= \left(\frac{10}{15} - \frac{3}{15} \right)p +
\frac{1}{5} \\
    \frac{1}{5} &amp;= \frac{7}{15} p \\
    p &amp;= \frac{15}{7} \cdot \frac{1}{5} = \frac{3}{7}
\end{align*}</span></p>
<p>Thus, <span class="math inline">P(C) = \frac{3}{7}</span>.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="problem-11">Problem 11</h2>
<p><i>Source: <a href="../fa21-final/index.html">Fall 2021 Final
Exam</a>, Problem 11</i></p>
<p>Below, we have a (real) sample of 12 passengers on the RMS Titanic, a
British cruise ship that tragically sank in 1912. For each passenger in
our sample, we have the following information:</p>
<ul>
<li><strong>survived</strong>: 1 if they survived the sinking of the
Titanic, 0 if they did not</li>
<li><strong>sex</strong>: either Male or Female</li>
<li><strong>class</strong>: the cabin class they were in, either First,
Second, or Third (with First being the most luxurious)</li>
<li><strong>age</strong>: either child (for those under 18) or adult
(for those 18 and older)</li>
</ul>
<div>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 24%" />
<col style="width: 24%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="header">
<th>survived   </th>
<th>sex   </th>
<th>class   </th>
<th>age   </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>female</td>
<td>Third</td>
<td>adult</td>
</tr>
<tr class="even">
<td>0</td>
<td>male</td>
<td>First</td>
<td>adult</td>
</tr>
<tr class="odd">
<td>0</td>
<td>male</td>
<td>Third</td>
<td>adult</td>
</tr>
<tr class="even">
<td>1</td>
<td>female</td>
<td>First</td>
<td>adult</td>
</tr>
<tr class="odd">
<td>1</td>
<td>female</td>
<td>First</td>
<td>adult</td>
</tr>
<tr class="even">
<td>1</td>
<td>female</td>
<td>First</td>
<td>child</td>
</tr>
<tr class="odd">
<td>1</td>
<td>female</td>
<td>Second</td>
<td>adult</td>
</tr>
<tr class="even">
<td>1</td>
<td>female</td>
<td>Second</td>
<td>adult</td>
</tr>
<tr class="odd">
<td>1</td>
<td>female</td>
<td>Third</td>
<td>adult</td>
</tr>
<tr class="even">
<td>1</td>
<td>female</td>
<td>Third</td>
<td>child</td>
</tr>
<tr class="odd">
<td>1</td>
<td>male</td>
<td>First</td>
<td>child</td>
</tr>
<tr class="even">
<td>1</td>
<td>male</td>
<td>Second</td>
<td>adult</td>
</tr>
</tbody>
</table>
</div>
<p><br></p>
<h3 id="problem-11.1">Problem 11.1</h3>
<p>Selma Augusta Emilia was a 38 year old female in Third class. Using
the Naive Bayes classification algorithm with no smoothing, predict
whether Selma Augusta Emilia survived the sinking of the Titanic. You
must show all intermediate steps, including the probabilities you used
to make your classification, and you must clearly state what your
prediction is.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_1">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_1" aria-expanded="true" aria-controls="collapse11_1">
Click to view the solution.
</button>
</h2>
<div id="collapse11_1" class="accordion-collapse collapse"
aria-labelledby="heading11_1" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p>We predict that Selma Augusta Emilia <strong>survived</strong> the
Titanic.</p>
<p>We want to determine which is larger, <span class="math inline">P(\text{1 | female, Third, adult})</span> or <span class="math inline">P(\text{0 | female, Third, adult})</span>, where 1
means the passenger survived and 0 means the passenger did not survive.
The Naive Bayes algorithm works by re-writing these two probabilities
using Bayes’ theorem, recognizing that we can determine which is larger
by comparing their numerators, and using an assumption of conditional
independence on their numerators.</p>
<p>Let’s first consider <span class="math inline">P(1 | \text{female,
Third, adult})</span>. By Bayes’ rule, the numerator of this probability
is <span class="math display">P(1) P(\text{female, Third, adult} |
1)</span> and by the assumption of conditional independence given a
class, this is equal to</p>
<p><span class="math display">P(1) P(\text{female} | 1) P(\text{Third} |
1) P(\text{adult} | 1)</span></p>
<p>We can estimate these four probabilities using our training set.</p>
<ul>
<li><span class="math inline">P(1) = \frac{9}{12} = \frac{3}{4}</span>,
because 9 of the 12 people in our training dataset are survivors
(survived = 1).</li>
<li><span class="math inline">P(\text{female} | 1) = \frac{7}{9}</span>,
because 7 of the 9 survivors in our dataset are female.</li>
<li><span class="math inline">P(\text{Third} | 1) = \frac{2}{9}</span>,
because 2 of the 9 survivors in our dataset are in Third class.</li>
<li><span class="math inline">P(\text{adult} | 1) = \frac{6}{9} =
\frac{2}{3}</span>, because 6 of the 9 survivors in our dataset are
adults.</li>
</ul>
<p>So, this numerator becomes</p>
<p><span class="math display">P(1) P(\text{female} | 1) P(\text{Third} |
1) P(\text{adult} | 1) = \frac{3}{4} \cdot \frac{7}{9} \cdot \frac{2}{9}
\cdot \frac{2}{3} = \frac{7}{81}</span></p>
<p>Similarly, we must estimate <span class="math inline">P(0)
P(\text{female} | 0) P(\text{Third} | 0) P(\text{adult} | 0)</span>:</p>
<ul>
<li><span class="math inline">P(0) = \frac{3}{12} = \frac{1}{4}</span>,
because 3 of the 12 people in our training dataset are not survivors
(survived = 0).</li>
<li><span class="math inline">P(\text{female} | 0) = \frac{1}{3}</span>,
because 1 of the 3 non-survivors in our dataset are female.</li>
<li><span class="math inline">P(\text{Third} | 0) = \frac{2}{3}</span>,
because 2 of the 3 non-survivors in our dataset are in Third class.</li>
<li><span class="math inline">P(\text{adult} | 0) = \frac{3}{3} =
1</span>, because all 3 of the non-survivors in our dataset are
adults.</li>
</ul>
<p>Then, we have</p>
<p><span class="math display">P(0) P(\text{female} | 0) P(\text{Third} |
0) P(\text{adult} | 0) = \frac{1}{4} \cdot \frac{1}{3} \cdot \frac{2}{3}
\cdot 1 = \frac{1}{18}</span></p>
<p>Note that <span class="math inline">\frac{1}{18} =
\frac{4.5}{81}</span>. Since this is smaller than <span class="math inline">\frac{7}{81}</span>, the numerator for class 1, we
predict that Selma Augusta Emilia survived the Titanic.</p>
</div>
</div>
</div>
</div>
<p><br></p>
<h3 id="problem-11.2">Problem 11.2</h3>
<p>If you try to use Naive Bayes to classify whether Selma Augusta
Emilia’s 8 year old daughter (who also sat with her in Third class)
survived the Titanic, one of the two probabilities that you’d compare
would turn out to be 0.</p>
<p>Using smoothing, compute <span class="math inline">P(\text{child } |
\text{ survived})</span> and <span class="math inline">P(\text{child } |
\text{ didn&#39;t survive})</span>. Show your work. Note that all you
need to do is find these two probabilities; you don’t need to make any
predictions.</p>
<div id="accordionExample" class="accordion">
<div class="accordion-item">
<h2 class="accordion-header" id="heading11_2">
<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11_2" aria-expanded="true" aria-controls="collapse11_2">
Click to view the solution.
</button>
</h2>
<div id="collapse11_2" class="accordion-collapse collapse"
aria-labelledby="heading11_2" data-bs-parent="#accordionExample">
<div class="accordion-body">
<header id="title-block-header">
<h1 class="title"> </h1>
</header>
<p><span class="math display">P(\text{child } | \text{ survived}) =
\displaystyle\frac{4}{11}, P(\text{child } | \text{ didn't survive})
= \displaystyle\frac{1}{5}</span></p>
<p>Note that this subpart uses the notation <span class="math inline">P(\text{child } | \text{ survived})</span> and <span class="math inline">P(\text{child } | \text{ didn't
survive})</span>; these are equivalent to <span class="math inline">P(\text{child} | 1)</span> and <span class="math inline">P(\text{child} | 0)</span> using the notation in the
previous subpart’s solution.</p>
<p><span class="math display">P(\text{child } | \text{ survived}) =
\frac{(\text{\# children that survived} + 1)}{(\text{\# children that
survived} + 1) + \text{(\# adults that survived} + 1)}</span> <span class="math display">= \frac{3 + 1}{(3 + 1) + (6 + 1)} =
\frac{4}{11}</span></p>
<p><span class="math display">P(\text{child } | \text{ didn't
survive}) = \frac{(\text{\# children that didn't survive} +
1)}{(\text{\# children that didn't survive} + 1) + \text{(\# adults
that didn't survive} + 1)}</span> <span class="math display">=
\frac{0 + 1}{(0 + 1) + (3 + 1)} = \frac{1}{5}</span></p>
</div>
</div>
</div>
</div>
<p><br></p>
<hr />
<h2 id="section"><span class="math display"> </span></h2>
<h4
id="feedback-find-an-error-still-confused-have-a-suggestion-let-us-know-here.">👋
Feedback: Find an error? Still confused? Have a suggestion?
<a href="https://forms.gle/WZ71FchnXU1K154d7">Let us know
here</u></a>.</h4>
<hr />
</body>
</html>
